[0m14:26:49.206442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF1BB190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF566C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF432FD0>]}


============================== 14:26:49.216611 | 0a4207df-c884-4da5-9b65-888100dc5432 ==============================
[0m14:26:49.216611 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:26:49.216611 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m14:26:49.246564 [info ] [MainThread]: dbt version: 1.11.2
[0m14:26:49.246564 [info ] [MainThread]: python version: 3.11.0
[0m14:26:49.246564 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m14:26:49.250264 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:26:49.478556 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m14:26:49.478556 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m14:26:49.478556 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m14:26:49.478556 [info ] [MainThread]: adapter type: postgres
[0m14:26:49.478556 [info ] [MainThread]: adapter version: 1.10.0
[0m14:26:49.600574 [info ] [MainThread]: Configuration:
[0m14:26:49.600574 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:26:49.600574 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:26:49.606724 [info ] [MainThread]: Required dependencies:
[0m14:26:49.606724 [debug] [MainThread]: Executing "git --help"
[0m14:26:49.651374 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:26:49.651374 [debug] [MainThread]: STDERR: "b''"
[0m14:26:49.656610 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:26:49.656610 [info ] [MainThread]: Connection:
[0m14:26:49.656610 [info ] [MainThread]:   host: localhost
[0m14:26:49.656610 [info ] [MainThread]:   port: 5432
[0m14:26:49.656610 [info ] [MainThread]:   user: your_username
[0m14:26:49.656610 [info ] [MainThread]:   database: medical_warehouse
[0m14:26:49.656610 [info ] [MainThread]:   schema: analytics
[0m14:26:49.656610 [info ] [MainThread]:   connect_timeout: 10
[0m14:26:49.656610 [info ] [MainThread]:   role: None
[0m14:26:49.656610 [info ] [MainThread]:   search_path: None
[0m14:26:49.656610 [info ] [MainThread]:   keepalives_idle: 0
[0m14:26:49.656610 [info ] [MainThread]:   sslmode: None
[0m14:26:49.664783 [info ] [MainThread]:   sslcert: None
[0m14:26:49.665401 [info ] [MainThread]:   sslkey: None
[0m14:26:49.665401 [info ] [MainThread]:   sslrootcert: None
[0m14:26:49.666407 [info ] [MainThread]:   application_name: dbt
[0m14:26:49.667415 [info ] [MainThread]:   retries: 1
[0m14:26:49.668417 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:26:49.946449 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:26:53.151524 [debug] [MainThread]: Using postgres connection "debug"
[0m14:26:53.156533 [debug] [MainThread]: On debug: select 1 as id
[0m14:26:53.156533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:57.231512 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m14:27:01.298272 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:27:01.298272 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:27:01.298272 [debug] [MainThread]: On debug: No close available on handle
[0m14:27:01.298272 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:27:01.302255 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:27:01.302255 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:27:01.306589 [debug] [MainThread]: Command `dbt debug` failed at 14:27:01.306589 after 12.16 seconds
[0m14:27:01.306589 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:27:01.308826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF543C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195A8B00D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195A8B00E50>]}
[0m14:27:01.308826 [debug] [MainThread]: Flushing usage events
[0m14:27:02.563678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:05.032382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381ED6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381ED6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381EC4D10>]}


============================== 14:27:05.036626 | bd60c80f-44d4-4242-bee7-c90ae17c4327 ==============================
[0m14:27:05.036626 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:27:05.036626 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m14:27:05.301624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd60c80f-44d4-4242-bee7-c90ae17c4327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381F65A50>]}
[0m14:27:05.356366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd60c80f-44d4-4242-bee7-c90ae17c4327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE6D0F50>]}
[0m14:27:05.366648 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:27:05.658937 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:27:05.660946 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:27:05.660946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd60c80f-44d4-4242-bee7-c90ae17c4327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383346C10>]}
[0m14:27:08.086700 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models\staging\schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m14:27:08.086700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd60c80f-44d4-4242-bee7-c90ae17c4327', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138352C3D0>]}
[0m14:27:08.109316 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m14:27:08.112069 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:27:08.113077 [debug] [MainThread]: Command `dbt docs generate` failed at 14:27:08.113077 after 3.16 seconds
[0m14:27:08.113077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381ED4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021381C79F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213834BA190>]}
[0m14:27:08.113077 [debug] [MainThread]: Flushing usage events
[0m14:27:09.218852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:11.611614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8376610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8292310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8291690>]}


============================== 14:27:11.614982 | 8ffb9fe4-3ba5-4a0b-99dc-e96011251eec ==============================
[0m14:27:11.614982 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:27:11.616523 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m14:27:11.816385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ffb9fe4-3ba5-4a0b-99dc-e96011251eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8367410>]}
[0m14:27:11.890503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ffb9fe4-3ba5-4a0b-99dc-e96011251eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C4C009D0>]}
[0m14:27:11.926515 [error] [MainThread]: Encountered an error:
[WinError 2] The system cannot find the file specified: 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\target'
[0m14:27:11.928520 [error] [MainThread]: Traceback (most recent call last):
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [WinError 2] The system cannot find the file specified: 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\target'

[0m14:27:11.930637 [debug] [MainThread]: Command `dbt docs serve` failed at 14:27:11.930637 after 0.38 seconds
[0m14:27:11.930637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C83D4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C83D5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8367D90>]}
[0m14:27:11.931637 [debug] [MainThread]: Flushing usage events
[0m14:27:13.066760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:15.277434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76C1E0E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76B25A250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76C259450>]}


============================== 14:43:15.285581 | 96c05dca-705e-429a-81ac-e7dabf1e5925 ==============================
[0m14:43:15.285581 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:43:15.285581 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m14:43:15.313257 [info ] [MainThread]: dbt version: 1.11.2
[0m14:43:15.313257 [info ] [MainThread]: python version: 3.11.0
[0m14:43:15.313257 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m14:43:15.313257 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:43:15.372696 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m14:43:15.377400 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m14:43:15.378446 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m14:43:15.522832 [info ] [MainThread]: Configuration:
[0m14:43:15.527382 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:43:15.527876 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:43:15.527876 [info ] [MainThread]: Required dependencies:
[0m14:43:15.527876 [debug] [MainThread]: Executing "git --help"
[0m14:43:15.582636 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:43:15.582636 [debug] [MainThread]: STDERR: "b''"
[0m14:43:15.582636 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:43:15.587930 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:43:15.587930 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:43:15.587930 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "medical_warehouse", target "dev" invalid: 12345678 is not of type 'string'


[0m14:43:15.587930 [debug] [MainThread]: Command `dbt debug` failed at 14:43:15.587930 after 0.39 seconds
[0m14:43:15.587930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BF999D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BF9A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76C22FD50>]}
[0m14:43:15.587930 [debug] [MainThread]: Flushing usage events
[0m14:43:16.906402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:20.823744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBAF179C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBAEFCD1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBAF17AD90>]}


============================== 14:46:20.826315 | 1a9015bf-2edc-4241-964e-21818b8066c8 ==============================
[0m14:46:20.826315 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:46:20.831988 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m14:46:20.895701 [info ] [MainThread]: dbt version: 1.11.2
[0m14:46:20.902914 [info ] [MainThread]: python version: 3.11.0
[0m14:46:20.908959 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m14:46:20.916862 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:46:21.153895 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m14:46:21.153895 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m14:46:21.155905 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m14:46:21.157936 [info ] [MainThread]: adapter type: postgres
[0m14:46:21.159946 [info ] [MainThread]: adapter version: 1.10.0
[0m14:46:21.371727 [info ] [MainThread]: Configuration:
[0m14:46:21.371727 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:46:21.371727 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:46:21.371727 [info ] [MainThread]: Required dependencies:
[0m14:46:21.371727 [debug] [MainThread]: Executing "git --help"
[0m14:46:21.436473 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:46:21.436473 [debug] [MainThread]: STDERR: "b''"
[0m14:46:21.441887 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:46:21.441887 [info ] [MainThread]: Connection:
[0m14:46:21.443897 [info ] [MainThread]:   host: localhost
[0m14:46:21.443897 [info ] [MainThread]:   port: 5432
[0m14:46:21.445915 [info ] [MainThread]:   user: postgres
[0m14:46:21.445915 [info ] [MainThread]:   database: medical_warehouse
[0m14:46:21.445915 [info ] [MainThread]:   schema: analytics
[0m14:46:21.445915 [info ] [MainThread]:   connect_timeout: 10
[0m14:46:21.449946 [info ] [MainThread]:   role: None
[0m14:46:21.450962 [info ] [MainThread]:   search_path: None
[0m14:46:21.451961 [info ] [MainThread]:   keepalives_idle: 0
[0m14:46:21.453049 [info ] [MainThread]:   sslmode: None
[0m14:46:21.453799 [info ] [MainThread]:   sslcert: None
[0m14:46:21.454239 [info ] [MainThread]:   sslkey: None
[0m14:46:21.456248 [info ] [MainThread]:   sslrootcert: None
[0m14:46:21.456248 [info ] [MainThread]:   application_name: dbt
[0m14:46:21.456248 [info ] [MainThread]:   retries: 1
[0m14:46:21.456248 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:46:21.875867 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:46:21.973995 [debug] [MainThread]: Using postgres connection "debug"
[0m14:46:21.973995 [debug] [MainThread]: On debug: select 1 as id
[0m14:46:21.976007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:26.049707 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m14:46:30.126686 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:46:30.128741 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:46:30.131770 [debug] [MainThread]: On debug: No close available on handle
[0m14:46:30.131770 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:46:30.137168 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:46:30.139206 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:46:30.146978 [debug] [MainThread]: Command `dbt debug` failed at 14:46:30.146978 after 9.41 seconds
[0m14:46:30.149351 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:46:30.150350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBB02FDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBA8700D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EBA8700E50>]}
[0m14:46:30.151857 [debug] [MainThread]: Flushing usage events
[0m14:46:31.252003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:42.798688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB57E4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB5838490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB571D090>]}


============================== 20:33:42.807273 | 3f8fffac-e3fb-4b5b-b8f5-4318144d0d41 ==============================
[0m20:33:42.807273 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:33:42.809245 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m20:33:42.848251 [info ] [MainThread]: dbt version: 1.11.2
[0m20:33:42.848251 [info ] [MainThread]: python version: 3.11.0
[0m20:33:42.848251 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m20:33:42.848251 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m20:33:43.188571 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m20:33:43.188571 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m20:33:43.188571 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m20:33:43.188571 [info ] [MainThread]: adapter type: postgres
[0m20:33:43.198194 [info ] [MainThread]: adapter version: 1.10.0
[0m20:33:43.555133 [info ] [MainThread]: Configuration:
[0m20:33:43.557133 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:33:43.559447 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:33:43.565758 [info ] [MainThread]: Required dependencies:
[0m20:33:43.567753 [debug] [MainThread]: Executing "git --help"
[0m20:33:43.743439 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:33:43.746175 [debug] [MainThread]: STDERR: "b''"
[0m20:33:43.747261 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:33:43.747261 [info ] [MainThread]: Connection:
[0m20:33:43.751601 [info ] [MainThread]:   host: localhost
[0m20:33:43.751601 [info ] [MainThread]:   port: 5432
[0m20:33:43.751601 [info ] [MainThread]:   user: postgres
[0m20:33:43.751601 [info ] [MainThread]:   database: medical_warehouse
[0m20:33:43.756563 [info ] [MainThread]:   schema: analytics
[0m20:33:43.759350 [info ] [MainThread]:   connect_timeout: 10
[0m20:33:43.760350 [info ] [MainThread]:   role: None
[0m20:33:43.761356 [info ] [MainThread]:   search_path: None
[0m20:33:43.764722 [info ] [MainThread]:   keepalives_idle: 0
[0m20:33:43.766726 [info ] [MainThread]:   sslmode: None
[0m20:33:43.769234 [info ] [MainThread]:   sslcert: None
[0m20:33:43.771254 [info ] [MainThread]:   sslkey: None
[0m20:33:43.773249 [info ] [MainThread]:   sslrootcert: None
[0m20:33:43.776147 [info ] [MainThread]:   application_name: dbt
[0m20:33:43.902002 [info ] [MainThread]:   retries: 1
[0m20:33:43.904973 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:33:44.646499 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:33:48.321353 [debug] [MainThread]: Using postgres connection "debug"
[0m20:33:48.323103 [debug] [MainThread]: On debug: select 1 as id
[0m20:33:48.323103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:52.410941 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m20:33:56.476713 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:33:56.476713 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:33:56.476713 [debug] [MainThread]: On debug: No close available on handle
[0m20:33:56.476713 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:33:56.476713 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:33:56.476713 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:33:56.476713 [debug] [MainThread]: Command `dbt debug` failed at 20:33:56.476713 after 13.82 seconds
[0m20:33:56.476713 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:33:56.476713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB57D3E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB5595AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EAED70D90>]}
[0m20:33:56.476713 [debug] [MainThread]: Flushing usage events
[0m20:33:57.984039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:36.469211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA614C6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA615183D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA61519410>]}


============================== 20:37:36.475701 | c19fcedd-0dca-4772-92c8-82feacc56a16 ==============================
[0m20:37:36.475701 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:37:36.476651 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m20:37:36.508583 [info ] [MainThread]: dbt version: 1.11.2
[0m20:37:36.509583 [info ] [MainThread]: python version: 3.11.0
[0m20:37:36.510582 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m20:37:36.511589 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m20:37:36.612484 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m20:37:36.613485 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m20:37:36.614486 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m20:37:36.616491 [info ] [MainThread]: adapter type: postgres
[0m20:37:36.617607 [info ] [MainThread]: adapter version: 1.10.0
[0m20:37:36.779432 [info ] [MainThread]: Configuration:
[0m20:37:36.779432 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:37:36.782650 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:37:36.782650 [info ] [MainThread]: Required dependencies:
[0m20:37:36.782650 [debug] [MainThread]: Executing "git --help"
[0m20:37:36.863182 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:37:36.864176 [debug] [MainThread]: STDERR: "b''"
[0m20:37:36.864176 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:37:36.866211 [info ] [MainThread]: Connection:
[0m20:37:36.867220 [info ] [MainThread]:   host: localhost
[0m20:37:36.868222 [info ] [MainThread]:   port: 5432
[0m20:37:36.869220 [info ] [MainThread]:   user: postgres
[0m20:37:36.870219 [info ] [MainThread]:   database: medical_warehouse
[0m20:37:36.871222 [info ] [MainThread]:   schema: analytics
[0m20:37:36.872225 [info ] [MainThread]:   connect_timeout: 10
[0m20:37:36.873223 [info ] [MainThread]:   role: None
[0m20:37:36.874218 [info ] [MainThread]:   search_path: None
[0m20:37:36.875727 [info ] [MainThread]:   keepalives_idle: 0
[0m20:37:36.876742 [info ] [MainThread]:   sslmode: None
[0m20:37:36.878018 [info ] [MainThread]:   sslcert: None
[0m20:37:36.879020 [info ] [MainThread]:   sslkey: None
[0m20:37:36.881024 [info ] [MainThread]:   sslrootcert: None
[0m20:37:36.882024 [info ] [MainThread]:   application_name: dbt
[0m20:37:36.883022 [info ] [MainThread]:   retries: 1
[0m20:37:36.885022 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:37:37.341792 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:37:37.442897 [debug] [MainThread]: Using postgres connection "debug"
[0m20:37:37.443902 [debug] [MainThread]: On debug: select 1 as id
[0m20:37:37.443902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:41.495166 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m20:37:45.530438 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:37:45.530438 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:37:45.530438 [debug] [MainThread]: On debug: No close available on handle
[0m20:37:45.530438 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:37:45.530438 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:37:45.530438 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:37:45.537714 [debug] [MainThread]: Command `dbt debug` failed at 20:37:45.537714 after 9.16 seconds
[0m20:37:45.537714 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:37:45.541060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA614D5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA614D5A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA604BC310>]}
[0m20:37:45.541060 [debug] [MainThread]: Flushing usage events
[0m20:37:46.947418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:59.139223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FE05F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FE78D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FE053D0>]}


============================== 20:48:59.146511 | 2b13fd0d-3c81-4e85-bdfb-c00a1e5bb838 ==============================
[0m20:48:59.146511 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:48:59.146511 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m20:48:59.174963 [info ] [MainThread]: dbt version: 1.11.2
[0m20:48:59.174963 [info ] [MainThread]: python version: 3.11.0
[0m20:48:59.174963 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m20:48:59.177696 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m20:48:59.261082 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m20:48:59.261768 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m20:48:59.262774 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m20:48:59.264127 [info ] [MainThread]: adapter type: postgres
[0m20:48:59.264127 [info ] [MainThread]: adapter version: 1.10.0
[0m20:48:59.363904 [info ] [MainThread]: Configuration:
[0m20:48:59.363904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:48:59.363904 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:48:59.363904 [info ] [MainThread]: Required dependencies:
[0m20:48:59.363904 [debug] [MainThread]: Executing "git --help"
[0m20:48:59.417734 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:48:59.417734 [debug] [MainThread]: STDERR: "b''"
[0m20:48:59.417734 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:48:59.417734 [info ] [MainThread]: Connection:
[0m20:48:59.417734 [info ] [MainThread]:   host: localhost
[0m20:48:59.417734 [info ] [MainThread]:   port: 5432
[0m20:48:59.417734 [info ] [MainThread]:   user: postgres
[0m20:48:59.417734 [info ] [MainThread]:   database: medical_warehouse
[0m20:48:59.417734 [info ] [MainThread]:   schema: analytics
[0m20:48:59.423965 [info ] [MainThread]:   connect_timeout: 10
[0m20:48:59.424570 [info ] [MainThread]:   role: None
[0m20:48:59.425578 [info ] [MainThread]:   search_path: None
[0m20:48:59.425578 [info ] [MainThread]:   keepalives_idle: 0
[0m20:48:59.426863 [info ] [MainThread]:   sslmode: None
[0m20:48:59.426863 [info ] [MainThread]:   sslcert: None
[0m20:48:59.427865 [info ] [MainThread]:   sslkey: None
[0m20:48:59.428866 [info ] [MainThread]:   sslrootcert: None
[0m20:48:59.428866 [info ] [MainThread]:   application_name: dbt
[0m20:48:59.429863 [info ] [MainThread]:   retries: 1
[0m20:48:59.430864 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:48:59.729018 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:48:59.807669 [debug] [MainThread]: Using postgres connection "debug"
[0m20:48:59.808997 [debug] [MainThread]: On debug: select 1 as id
[0m20:48:59.808997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:59.890414 [debug] [MainThread]: SQL status: SELECT 1 in 0.081 seconds
[0m20:48:59.890897 [debug] [MainThread]: On debug: Close
[0m20:48:59.892146 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:48:59.892146 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:48:59.894147 [debug] [MainThread]: Command `dbt debug` succeeded at 20:48:59.894147 after 0.82 seconds
[0m20:48:59.895146 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:48:59.895146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5FDF3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF59370E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF590C7190>]}
[0m20:48:59.896415 [debug] [MainThread]: Flushing usage events
[0m20:49:01.166284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:03.475231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D895AC6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D895B24E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D895AB1850>]}


============================== 20:50:03.480913 | 4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf ==============================
[0m20:50:03.480913 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:50:03.481965 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m20:50:03.707246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D896D29150>]}
[0m20:50:03.770547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8922F0990>]}
[0m20:50:03.772484 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:50:04.087132 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:50:04.088879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:50:04.089455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D896D79F90>]}
[0m20:50:06.661637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D89707B810>]}
[0m20:50:06.758390 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m20:50:06.778999 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m20:50:06.813053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8974A1CD0>]}
[0m20:50:06.813053 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m20:50:06.813053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8973BB510>]}
[0m20:50:06.816346 [info ] [MainThread]: 
[0m20:50:06.816346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:06.816346 [info ] [MainThread]: 
[0m20:50:06.816346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:06.823649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m20:50:06.915464 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m20:50:06.916461 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:50:06.917430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:06.941701 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m20:50:06.941701 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m20:50:06.948017 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m20:50:06.948017 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:50:06.950024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:06.982914 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.036 seconds
[0m20:50:06.982914 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m20:50:06.988652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse, now create_medical_warehouse_analytics_staging)
[0m20:50:06.989286 [debug] [ThreadPool]: Creating schema "database: "medical_warehouse"
schema: "analytics_staging"
"
[0m20:50:06.993234 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_analytics_staging"
[0m20:50:06.993234 [debug] [ThreadPool]: On create_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "create_medical_warehouse_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m20:50:06.993234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:07.014707 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.021 seconds
[0m20:50:07.014707 [debug] [ThreadPool]: On create_medical_warehouse_analytics_staging: COMMIT
[0m20:50:07.018926 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_analytics_staging"
[0m20:50:07.018926 [debug] [ThreadPool]: On create_medical_warehouse_analytics_staging: COMMIT
[0m20:50:07.020922 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m20:50:07.025026 [debug] [ThreadPool]: On create_medical_warehouse_analytics_staging: Close
[0m20:50:07.025026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medical_warehouse_analytics_staging, now create_medical_warehouse_analytics_marts)
[0m20:50:07.025026 [debug] [ThreadPool]: Creating schema "database: "medical_warehouse"
schema: "analytics_marts"
"
[0m20:50:07.025026 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_analytics_marts"
[0m20:50:07.025026 [debug] [ThreadPool]: On create_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "create_medical_warehouse_analytics_marts"} */
create schema if not exists "analytics_marts"
[0m20:50:07.031957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:07.056098 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.033 seconds
[0m20:50:07.066945 [debug] [ThreadPool]: On create_medical_warehouse_analytics_marts: COMMIT
[0m20:50:07.066945 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_analytics_marts"
[0m20:50:07.066945 [debug] [ThreadPool]: On create_medical_warehouse_analytics_marts: COMMIT
[0m20:50:07.068460 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m20:50:07.068460 [debug] [ThreadPool]: On create_medical_warehouse_analytics_marts: Close
[0m20:50:07.074271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m20:50:07.076810 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m20:50:07.076810 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m20:50:07.076810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:07.114363 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.034 seconds
[0m20:50:07.114363 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m20:50:07.118149 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m20:50:07.118149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m20:50:07.118149 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m20:50:07.118149 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m20:50:07.118149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:07.145693 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m20:50:07.147712 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m20:50:07.148719 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m20:50:07.150838 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:07.150838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:50:07.150838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:07.190347 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m20:50:07.193594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D896C6E990>]}
[0m20:50:07.193594 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:07.193594 [debug] [MainThread]: On master: COMMIT
[0m20:50:07.193594 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:07.193594 [debug] [MainThread]: On master: COMMIT
[0m20:50:07.193594 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:50:07.200784 [debug] [MainThread]: On master: Close
[0m20:50:07.209105 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m20:50:07.209785 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m20:50:07.211300 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m20:50:07.211300 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m20:50:07.221551 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m20:50:07.223632 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m20:50:07.274025 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m20:50:07.277159 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m20:50:07.278165 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select
        message_id,
        channel_name,
        date::timestamp as message_date,
        message_text,
        length(message_text) as message_length,
        coalesce(view_count, 0) as view_count,
        coalesce(forward_count, 0) as forward_count,
        coalesce(has_image, false) as has_image,
        image_path
    from "medical_warehouse"."raw"."telegram_messages"
    where message_text is not null
)

select * from source
  );
[0m20:50:07.279164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:07.314958 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.telegram_messages" does not exist
LINE 20:     from "medical_warehouse"."raw"."telegram_messages"
                  ^

[0m20:50:07.314958 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m20:50:07.314958 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m20:50:07.479302 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 20:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:50:07.483900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8b9ddf-b4cd-4cae-b99c-a71964bf68bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D89720C350>]}
[0m20:50:07.485420 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_staging.stg_telegram_messages ... [[31mERROR[0m in 0.27s]
[0m20:50:07.485420 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m20:50:07.485420 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 20:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql.
[0m20:50:07.488615 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m20:50:07.489631 [info ] [Thread-1 (]: 2 of 2 SKIP relation analytics_marts.fct_messages .............................. [[33mSKIP[0m]
[0m20:50:07.489631 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m20:50:07.491730 [debug] [MainThread]: On master: COMMIT
[0m20:50:07.491730 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:07.491730 [debug] [MainThread]: On master: COMMIT
[0m20:50:07.491730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:07.517311 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m20:50:07.518313 [debug] [MainThread]: On master: Close
[0m20:50:07.519974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:07.521017 [debug] [MainThread]: Connection 'create_medical_warehouse_analytics_marts' was properly closed.
[0m20:50:07.522029 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m20:50:07.523026 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m20:50:07.524026 [info ] [MainThread]: 
[0m20:50:07.525030 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m20:50:07.527026 [debug] [MainThread]: Command end result
[0m20:50:07.562320 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m20:50:07.562320 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m20:50:07.573120 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m20:50:07.574069 [info ] [MainThread]: 
[0m20:50:07.574790 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:07.574790 [info ] [MainThread]: 
[0m20:50:07.574790 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)[0m
[0m20:50:07.574790 [error] [MainThread]:   Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 20:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:50:07.574790 [info ] [MainThread]: 
[0m20:50:07.574790 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:50:07.574790 [info ] [MainThread]: 
[0m20:50:07.574790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m20:50:07.582832 [debug] [MainThread]: Command `dbt run` failed at 20:50:07.582832 after 4.16 seconds
[0m20:50:07.582832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D895B01A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D88ED96610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D897396010>]}
[0m20:50:07.582832 [debug] [MainThread]: Flushing usage events
[0m20:50:10.006891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:27.675193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5448E6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5448E6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5448E6AD0>]}


============================== 20:58:27.689004 | a862fffc-4aad-4354-88c6-0ced05582526 ==============================
[0m20:58:27.689004 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:58:27.689004 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m20:58:27.893960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5459FCF90>]}
[0m20:58:27.972355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5411107D0>]}
[0m20:58:27.974392 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:58:28.421493 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:58:28.606399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:28.607667 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\stg_telegram_messages.sql
[0m20:58:28.910295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D545A88910>]}
[0m20:58:29.001863 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m20:58:29.005448 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m20:58:29.080276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D545DB9250>]}
[0m20:58:29.081473 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m20:58:29.082438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D546016950>]}
[0m20:58:29.084055 [info ] [MainThread]: 
[0m20:58:29.085031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:29.085031 [info ] [MainThread]: 
[0m20:58:29.086359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:29.091067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m20:58:29.170553 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m20:58:29.170553 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:58:29.170553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:29.221473 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m20:58:29.221473 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m20:58:29.221473 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m20:58:29.221473 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:58:29.221473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:29.242512 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m20:58:29.242512 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m20:58:29.251346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m20:58:29.253766 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m20:58:29.253766 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m20:58:29.253766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:29.286064 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m20:58:29.286064 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m20:58:29.286064 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m20:58:29.286064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m20:58:29.294275 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m20:58:29.294275 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m20:58:29.294275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:29.333308 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.037 seconds
[0m20:58:29.336171 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m20:58:29.336171 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m20:58:29.343792 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:29.343792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:58:29.343792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:29.386050 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m20:58:29.386050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D546407CD0>]}
[0m20:58:29.386050 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:29.388877 [debug] [MainThread]: On master: COMMIT
[0m20:58:29.388877 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:29.388877 [debug] [MainThread]: On master: COMMIT
[0m20:58:29.388877 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:58:29.388877 [debug] [MainThread]: On master: Close
[0m20:58:29.399190 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m20:58:29.399190 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m20:58:29.399190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m20:58:29.401263 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m20:58:29.409515 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m20:58:29.409515 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m20:58:29.443229 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m20:58:29.450750 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m20:58:29.450750 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from "medical_warehouse"."raw"."telegram_messages"

),

cleaned as (

    select
        message_id,
        channel_name,
        message_text,
        message_date::timestamp as message_date,
        views::int as view_count,
        forwards::int as forward_count,
        has_media,
        length(message_text) as message_length
    from source
    where message_text is not null

)

select * from cleaned
  );
[0m20:58:29.450750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:58:29.486333 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.telegram_messages" does not exist
LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                  ^

[0m20:58:29.486333 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m20:58:29.486333 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m20:58:29.495377 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:58:29.495377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a862fffc-4aad-4354-88c6-0ced05582526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D546423D50>]}
[0m20:58:29.495377 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_staging.stg_telegram_messages ... [[31mERROR[0m in 0.10s]
[0m20:58:29.495377 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m20:58:29.495377 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql.
[0m20:58:29.502328 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m20:58:29.502710 [info ] [Thread-1 (]: 2 of 2 SKIP relation analytics_marts.fct_messages .............................. [[33mSKIP[0m]
[0m20:58:29.502710 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m20:58:29.502710 [debug] [MainThread]: On master: COMMIT
[0m20:58:29.502710 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:29.502710 [debug] [MainThread]: On master: COMMIT
[0m20:58:29.502710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:29.525880 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m20:58:29.525880 [debug] [MainThread]: On master: Close
[0m20:58:29.525880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:29.525880 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m20:58:29.534193 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m20:58:29.534193 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m20:58:29.535587 [info ] [MainThread]: 
[0m20:58:29.536597 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:58:29.538597 [debug] [MainThread]: Command end result
[0m20:58:29.565402 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m20:58:29.566421 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m20:58:29.577594 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m20:58:29.577594 [info ] [MainThread]: 
[0m20:58:29.578593 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:58:29.579622 [info ] [MainThread]: 
[0m20:58:29.579622 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)[0m
[0m20:58:29.580625 [error] [MainThread]:   Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:58:29.580625 [info ] [MainThread]: 
[0m20:58:29.580625 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m20:58:29.580625 [info ] [MainThread]: 
[0m20:58:29.580625 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m20:58:29.580625 [debug] [MainThread]: Command `dbt run` failed at 20:58:29.580625 after 1.96 seconds
[0m20:58:29.585569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D54496CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D543A1CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5410E5BD0>]}
[0m20:58:29.586083 [debug] [MainThread]: Flushing usage events
[0m20:58:31.011250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:18.515073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A765C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A7B8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A41B290>]}


============================== 21:00:18.520063 | aadb5508-82cc-4887-84e5-706ecea086d0 ==============================
[0m21:00:18.520063 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:00:18.520063 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:00:18.543146 [info ] [MainThread]: dbt version: 1.11.2
[0m21:00:18.543842 [info ] [MainThread]: python version: 3.11.0
[0m21:00:18.543842 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m21:00:18.543842 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m21:00:18.602290 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m21:00:18.602290 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m21:00:18.602290 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m21:00:18.602290 [info ] [MainThread]: adapter type: postgres
[0m21:00:18.609161 [info ] [MainThread]: adapter version: 1.10.0
[0m21:00:18.715248 [info ] [MainThread]: Configuration:
[0m21:00:18.716455 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:00:18.716455 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:00:18.716455 [info ] [MainThread]: Required dependencies:
[0m21:00:18.716455 [debug] [MainThread]: Executing "git --help"
[0m21:00:18.760807 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:00:18.760807 [debug] [MainThread]: STDERR: "b''"
[0m21:00:18.760807 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:00:18.760807 [info ] [MainThread]: Connection:
[0m21:00:18.760807 [info ] [MainThread]:   host: localhost
[0m21:00:18.760807 [info ] [MainThread]:   port: 5432
[0m21:00:18.760807 [info ] [MainThread]:   user: postgres
[0m21:00:18.760807 [info ] [MainThread]:   database: medical_warehouse
[0m21:00:18.768131 [info ] [MainThread]:   schema: analytics
[0m21:00:18.768131 [info ] [MainThread]:   connect_timeout: 10
[0m21:00:18.768131 [info ] [MainThread]:   role: None
[0m21:00:18.768131 [info ] [MainThread]:   search_path: None
[0m21:00:18.768131 [info ] [MainThread]:   keepalives_idle: 0
[0m21:00:18.768131 [info ] [MainThread]:   sslmode: None
[0m21:00:18.768131 [info ] [MainThread]:   sslcert: None
[0m21:00:18.768131 [info ] [MainThread]:   sslkey: None
[0m21:00:18.768131 [info ] [MainThread]:   sslrootcert: None
[0m21:00:18.768131 [info ] [MainThread]:   application_name: dbt
[0m21:00:18.768131 [info ] [MainThread]:   retries: 1
[0m21:00:18.768131 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:00:19.046701 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:00:19.116267 [debug] [MainThread]: Using postgres connection "debug"
[0m21:00:19.116267 [debug] [MainThread]: On debug: select 1 as id
[0m21:00:19.116267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:19.139893 [debug] [MainThread]: SQL status: SELECT 1 in 0.023 seconds
[0m21:00:19.139893 [debug] [MainThread]: On debug: Close
[0m21:00:19.139893 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:00:19.139893 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:00:19.139893 [debug] [MainThread]: Command `dbt debug` succeeded at 21:00:19.139893 after 0.69 seconds
[0m21:00:19.139893 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:00:19.139893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A7D8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8A7DB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8BB55B90>]}
[0m21:00:19.139893 [debug] [MainThread]: Flushing usage events
[0m21:00:20.508032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:25.133795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D6A5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D6F1F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D6A7E50>]}


============================== 21:00:25.138427 | 54af991f-4d09-457a-b68c-c684f5f417d6 ==============================
[0m21:00:25.138427 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:00:25.138427 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:00:25.336449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E8D71D0>]}
[0m21:00:25.400062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020239ED0A10>]}
[0m21:00:25.400062 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:00:25.712661 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:00:25.859619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:25.859619 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:00:25.859619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:25.910248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E90B790>]}
[0m21:00:26.004016 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:00:26.006021 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:00:26.032633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023EB976D0>]}
[0m21:00:26.032633 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m21:00:26.032633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D712E10>]}
[0m21:00:26.032633 [info ] [MainThread]: 
[0m21:00:26.032633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:26.032633 [info ] [MainThread]: 
[0m21:00:26.032633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:26.042965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m21:00:26.128134 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:00:26.129129 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:00:26.129129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:26.152290 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m21:00:26.153290 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:00:26.157085 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:00:26.157085 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:00:26.158147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:26.187209 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m21:00:26.187209 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:00:26.190845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m21:00:26.197564 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m21:00:26.197564 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:00:26.197564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:26.229373 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m21:00:26.239314 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m21:00:26.239865 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m21:00:26.239865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m21:00:26.250216 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m21:00:26.250216 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:00:26.250216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:26.260422 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m21:00:26.270757 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m21:00:26.271430 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m21:00:26.312352 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:26.319052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:00:26.319680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:26.349608 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m21:00:26.351955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023C11A750>]}
[0m21:00:26.351955 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:26.353970 [debug] [MainThread]: On master: COMMIT
[0m21:00:26.353970 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:26.353970 [debug] [MainThread]: On master: COMMIT
[0m21:00:26.353970 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:00:26.353970 [debug] [MainThread]: On master: Close
[0m21:00:26.353970 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m21:00:26.353970 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m21:00:26.364325 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m21:00:26.364325 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m21:00:26.368002 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m21:00:26.368002 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m21:00:26.407895 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m21:00:26.407895 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:00:26.407895 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from "medical_warehouse"."raw"."telegram_messages"

),

cleaned as (

    select
        message_id,
        channel_name,
        message_text,
        message_date::timestamp as message_date,
        views::int as view_count,
        forwards::int as forward_count,
        has_media,
        length(message_text) as message_length
    from source
    where message_text is not null

)

select * from cleaned
  );
[0m21:00:26.407895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:26.435230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.telegram_messages" does not exist
LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                  ^

[0m21:00:26.435230 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m21:00:26.437798 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m21:00:26.442921 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:00:26.445917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54af991f-4d09-457a-b68c-c684f5f417d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D6F2CD0>]}
[0m21:00:26.445917 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_staging.stg_telegram_messages ... [[31mERROR[0m in 0.08s]
[0m21:00:26.446917 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m21:00:26.448189 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql.
[0m21:00:26.450154 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m21:00:26.450154 [info ] [Thread-1 (]: 2 of 2 SKIP relation analytics_marts.fct_messages .............................. [[33mSKIP[0m]
[0m21:00:26.451175 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m21:00:26.452184 [debug] [MainThread]: On master: COMMIT
[0m21:00:26.453216 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:26.453216 [debug] [MainThread]: On master: COMMIT
[0m21:00:26.454215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:26.485890 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m21:00:26.485890 [debug] [MainThread]: On master: Close
[0m21:00:26.485890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:26.488710 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m21:00:26.488710 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m21:00:26.488710 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m21:00:26.488710 [info ] [MainThread]: 
[0m21:00:26.491013 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m21:00:26.491730 [debug] [MainThread]: Command end result
[0m21:00:26.516573 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:00:26.519766 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:00:26.524403 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m21:00:26.524403 [info ] [MainThread]: 
[0m21:00:26.524403 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:00:26.530292 [info ] [MainThread]: 
[0m21:00:26.530292 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)[0m
[0m21:00:26.530292 [error] [MainThread]:   Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:00:26.530292 [info ] [MainThread]: 
[0m21:00:26.530292 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:00:26.534162 [info ] [MainThread]: 
[0m21:00:26.534162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m21:00:26.536677 [debug] [MainThread]: Command `dbt run` failed at 21:00:26.536677 after 1.46 seconds
[0m21:00:26.536677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023F0BFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020236976590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023F0C75D0>]}
[0m21:00:26.536677 [debug] [MainThread]: Flushing usage events
[0m21:00:27.774114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:31.439011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014539864510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001453895C990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001453895CA50>]}


============================== 21:02:31.443069 | 630db6f9-649c-4840-9dce-1d6889a60170 ==============================
[0m21:02:31.443069 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:02:31.443069 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:02:31.463741 [info ] [MainThread]: dbt version: 1.11.2
[0m21:02:31.463741 [info ] [MainThread]: python version: 3.11.0
[0m21:02:31.463741 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m21:02:31.474019 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m21:02:31.528670 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m21:02:31.528670 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m21:02:31.528670 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m21:02:31.528670 [info ] [MainThread]: adapter type: postgres
[0m21:02:31.528670 [info ] [MainThread]: adapter version: 1.10.0
[0m21:02:31.644134 [info ] [MainThread]: Configuration:
[0m21:02:31.650866 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:02:31.650866 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:02:31.650866 [info ] [MainThread]: Required dependencies:
[0m21:02:31.650866 [debug] [MainThread]: Executing "git --help"
[0m21:02:31.694630 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:02:31.697666 [debug] [MainThread]: STDERR: "b''"
[0m21:02:31.697666 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:02:31.697666 [info ] [MainThread]: Connection:
[0m21:02:31.697666 [info ] [MainThread]:   host: localhost
[0m21:02:31.697666 [info ] [MainThread]:   port: 5432
[0m21:02:31.697666 [info ] [MainThread]:   user: postgres
[0m21:02:31.701995 [info ] [MainThread]:   database: medical_warehouse
[0m21:02:31.701995 [info ] [MainThread]:   schema: analytics
[0m21:02:31.701995 [info ] [MainThread]:   connect_timeout: 10
[0m21:02:31.701995 [info ] [MainThread]:   role: None
[0m21:02:31.701995 [info ] [MainThread]:   search_path: None
[0m21:02:31.701995 [info ] [MainThread]:   keepalives_idle: 0
[0m21:02:31.701995 [info ] [MainThread]:   sslmode: None
[0m21:02:31.701995 [info ] [MainThread]:   sslcert: None
[0m21:02:31.701995 [info ] [MainThread]:   sslkey: None
[0m21:02:31.701995 [info ] [MainThread]:   sslrootcert: None
[0m21:02:31.701995 [info ] [MainThread]:   application_name: dbt
[0m21:02:31.701995 [info ] [MainThread]:   retries: 1
[0m21:02:31.710191 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:02:31.995308 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:02:32.060178 [debug] [MainThread]: Using postgres connection "debug"
[0m21:02:32.061259 [debug] [MainThread]: On debug: select 1 as id
[0m21:02:32.061804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:32.136974 [debug] [MainThread]: SQL status: SELECT 1 in 0.080 seconds
[0m21:02:32.142238 [debug] [MainThread]: On debug: Close
[0m21:02:32.143412 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:02:32.144923 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:02:32.146935 [debug] [MainThread]: Command `dbt debug` succeeded at 21:02:32.146935 after 0.77 seconds
[0m21:02:32.147936 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:02:32.149931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145398889D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001453988B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001453AC20BD0>]}
[0m21:02:32.150931 [debug] [MainThread]: Flushing usage events
[0m21:02:33.398983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:39.022793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011372D37A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011372D80C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011372DA1690>]}


============================== 21:02:39.022793 | 05a3dfef-a642-4889-b804-4a14f966960a ==============================
[0m21:02:39.022793 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:02:39.022793 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:02:39.225550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011372DB94D0>]}
[0m21:02:39.291796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001136F5A0210>]}
[0m21:02:39.293107 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:02:39.571004 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:02:39.705261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:39.705261 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:02:39.705261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:39.756647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011373F9C690>]}
[0m21:02:39.854943 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:02:39.857942 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:02:39.885596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113742E4110>]}
[0m21:02:39.886571 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m21:02:39.887573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011374236490>]}
[0m21:02:39.889595 [info ] [MainThread]: 
[0m21:02:39.889595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:39.890569 [info ] [MainThread]: 
[0m21:02:39.891610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:39.891610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m21:02:39.974429 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:02:39.975134 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:02:39.976238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:40.000642 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m21:02:40.000642 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:02:40.004404 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:02:40.004404 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:02:40.004404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:40.035656 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m21:02:40.040666 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:02:40.040666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m21:02:40.045980 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m21:02:40.045980 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:02:40.045980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:40.087668 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m21:02:40.087668 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m21:02:40.087668 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m21:02:40.087668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m21:02:40.087668 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m21:02:40.087668 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:02:40.087668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:40.134769 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.037 seconds
[0m21:02:40.135806 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m21:02:40.136787 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m21:02:40.180681 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:40.180681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:02:40.180681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:40.220575 [debug] [MainThread]: SQL status: SELECT 0 in 0.036 seconds
[0m21:02:40.222615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113747E5CD0>]}
[0m21:02:40.222615 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:40.222615 [debug] [MainThread]: On master: COMMIT
[0m21:02:40.222615 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:40.222615 [debug] [MainThread]: On master: COMMIT
[0m21:02:40.222615 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:02:40.222615 [debug] [MainThread]: On master: Close
[0m21:02:40.233133 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m21:02:40.233133 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m21:02:40.236215 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m21:02:40.236215 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m21:02:40.243681 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m21:02:40.245756 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m21:02:40.275202 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m21:02:40.275202 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:02:40.275202 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from "medical_warehouse"."raw"."telegram_messages"

),

cleaned as (

    select
        message_id,
        channel_name,
        message_text,
        message_date::timestamp as message_date,
        views::int as view_count,
        forwards::int as forward_count,
        has_media,
        length(message_text) as message_length
    from source
    where message_text is not null

)

select * from cleaned
  );
[0m21:02:40.275202 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:40.303007 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.telegram_messages" does not exist
LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                  ^

[0m21:02:40.304042 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m21:02:40.305003 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m21:02:40.311389 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:02:40.313386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a3dfef-a642-4889-b804-4a14f966960a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011372DD3F50>]}
[0m21:02:40.314385 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_staging.stg_telegram_messages ... [[31mERROR[0m in 0.08s]
[0m21:02:40.315353 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m21:02:40.316481 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql.
[0m21:02:40.317517 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m21:02:40.318482 [info ] [Thread-1 (]: 2 of 2 SKIP relation analytics_marts.fct_messages .............................. [[33mSKIP[0m]
[0m21:02:40.318482 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m21:02:40.320481 [debug] [MainThread]: On master: COMMIT
[0m21:02:40.320481 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:40.321518 [debug] [MainThread]: On master: COMMIT
[0m21:02:40.321518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:40.346035 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m21:02:40.346035 [debug] [MainThread]: On master: Close
[0m21:02:40.346035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:40.346035 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m21:02:40.346035 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m21:02:40.346035 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m21:02:40.346035 [info ] [MainThread]: 
[0m21:02:40.346035 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:02:40.346035 [debug] [MainThread]: Command end result
[0m21:02:40.387472 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:02:40.387472 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:02:40.401441 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m21:02:40.402440 [info ] [MainThread]: 
[0m21:02:40.403443 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:02:40.404800 [info ] [MainThread]: 
[0m21:02:40.404800 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)[0m
[0m21:02:40.404800 [error] [MainThread]:   Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  relation "raw.telegram_messages" does not exist
  LINE 10:     from "medical_warehouse"."raw"."telegram_messages"
                    ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:02:40.408085 [info ] [MainThread]: 
[0m21:02:40.409789 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m21:02:40.409789 [info ] [MainThread]: 
[0m21:02:40.409789 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m21:02:40.409789 [debug] [MainThread]: Command `dbt run` failed at 21:02:40.409789 after 1.45 seconds
[0m21:02:40.409789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001136C2D0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001137474AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001137474BE90>]}
[0m21:02:40.415109 [debug] [MainThread]: Flushing usage events
[0m21:02:42.559057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:47.126938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB626C6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB62718650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB627185D0>]}


============================== 21:10:47.126938 | a614b19a-7dae-4b10-87cf-32875ec53cc5 ==============================
[0m21:10:47.126938 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:10:47.126938 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:10:47.158759 [info ] [MainThread]: dbt version: 1.11.2
[0m21:10:47.158759 [info ] [MainThread]: python version: 3.11.0
[0m21:10:47.158759 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m21:10:47.158759 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m21:10:47.232765 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m21:10:47.233765 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m21:10:47.234783 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m21:10:47.235728 [info ] [MainThread]: adapter type: postgres
[0m21:10:47.236729 [info ] [MainThread]: adapter version: 1.10.0
[0m21:10:47.373526 [info ] [MainThread]: Configuration:
[0m21:10:47.374640 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:10:47.374640 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:10:47.374640 [info ] [MainThread]: Required dependencies:
[0m21:10:47.376776 [debug] [MainThread]: Executing "git --help"
[0m21:10:47.428283 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:10:47.428283 [debug] [MainThread]: STDERR: "b''"
[0m21:10:47.428283 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:10:47.428283 [info ] [MainThread]: Connection:
[0m21:10:47.428283 [info ] [MainThread]:   host: localhost
[0m21:10:47.428283 [info ] [MainThread]:   port: 5432
[0m21:10:47.428283 [info ] [MainThread]:   user: postgres
[0m21:10:47.428283 [info ] [MainThread]:   database: medical_warehouse
[0m21:10:47.428283 [info ] [MainThread]:   schema: analytics
[0m21:10:47.428283 [info ] [MainThread]:   connect_timeout: 10
[0m21:10:47.428283 [info ] [MainThread]:   role: None
[0m21:10:47.428283 [info ] [MainThread]:   search_path: None
[0m21:10:47.428283 [info ] [MainThread]:   keepalives_idle: 0
[0m21:10:47.438651 [info ] [MainThread]:   sslmode: None
[0m21:10:47.438651 [info ] [MainThread]:   sslcert: None
[0m21:10:47.440758 [info ] [MainThread]:   sslkey: None
[0m21:10:47.441767 [info ] [MainThread]:   sslrootcert: None
[0m21:10:47.442766 [info ] [MainThread]:   application_name: dbt
[0m21:10:47.443771 [info ] [MainThread]:   retries: 1
[0m21:10:47.444771 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:10:47.809437 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:10:47.870675 [debug] [MainThread]: Using postgres connection "debug"
[0m21:10:47.870675 [debug] [MainThread]: On debug: select 1 as id
[0m21:10:47.870675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:47.912448 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m21:10:47.917444 [debug] [MainThread]: On debug: Close
[0m21:10:47.917444 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:10:47.917444 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:10:47.921250 [debug] [MainThread]: Command `dbt debug` succeeded at 21:10:47.921250 after 0.86 seconds
[0m21:10:47.922793 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:10:47.922793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB626B3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5BCC0E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6384D390>]}
[0m21:10:47.922793 [debug] [MainThread]: Flushing usage events
[0m21:10:49.379676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:17.021895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D35F6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D3640310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D3664790>]}


============================== 21:14:17.021895 | d59d5626-db7f-40de-9736-485c5642871f ==============================
[0m21:14:17.021895 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:14:17.031829 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:14:17.227435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D486B550>]}
[0m21:14:17.299381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192CFE30190>]}
[0m21:14:17.301070 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:14:17.576052 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:14:17.723212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:17.723212 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\stg_telegram_messages.sql
[0m21:14:18.008780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D48BAC10>]}
[0m21:14:18.140585 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:14:18.142606 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:14:18.171246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D4CDF450>]}
[0m21:14:18.172886 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m21:14:18.172886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D4EFEC50>]}
[0m21:14:18.175502 [info ] [MainThread]: 
[0m21:14:18.175502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:18.176509 [info ] [MainThread]: 
[0m21:14:18.177509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:18.181514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m21:14:18.261742 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:14:18.261742 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:14:18.262748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:18.299598 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m21:14:18.303641 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:14:18.308112 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:14:18.308112 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:14:18.309110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:18.335722 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m21:14:18.336724 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:14:18.339588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m21:14:18.345160 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m21:14:18.346701 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:14:18.347706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:18.392355 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.054 seconds
[0m21:14:18.402780 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m21:14:18.402780 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m21:14:18.405572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m21:14:18.408444 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m21:14:18.409442 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:14:18.409442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:18.437109 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m21:14:18.438143 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m21:14:18.438839 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m21:14:18.444316 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:18.444316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:14:18.444316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:18.487126 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m21:14:18.488755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D4DE6C10>]}
[0m21:14:18.488755 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:18.488755 [debug] [MainThread]: On master: COMMIT
[0m21:14:18.488755 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:18.488755 [debug] [MainThread]: On master: COMMIT
[0m21:14:18.488755 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:14:18.488755 [debug] [MainThread]: On master: Close
[0m21:14:18.496145 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m21:14:18.496145 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m21:14:18.496145 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m21:14:18.496145 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m21:14:18.506259 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.506259 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m21:14:18.539441 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.539441 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.539441 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    select
    message_id,
    channel_name,
    message_text,
    message_date,
    length(message_text) as message_length,
    view_count,
    forward_count,
    has_media,
    image_path
from "medical_warehouse"."raw"."telegram_messages"
where message_text is not null
  );
[0m21:14:18.539441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:14:18.591157 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m21:14:18.597199 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.598197 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m21:14:18.599702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:14:18.609840 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m21:14:18.609840 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.609840 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m21:14:18.620408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:14:18.622569 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup"
[0m21:14:18.630808 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:14:18.630808 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup" cascade
[0m21:14:18.630808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:14:18.638444 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m21:14:18.640999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D51C0750>]}
[0m21:14:18.640999 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_staging.stg_telegram_messages ....... [[32mCREATE VIEW[0m in 0.14s]
[0m21:14:18.640999 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m21:14:18.640999 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m21:14:18.640999 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_marts.fct_messages ...................... [RUN]
[0m21:14:18.640999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fct_messages)
[0m21:14:18.640999 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m21:14:18.651318 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m21:14:18.655601 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m21:14:18.682241 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m21:14:18.682241 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m21:14:18.682241 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    m.message_id,
    c.channel_key,
    d.date_key,
    m.message_text,
    m.message_length,
    m.view_count,
    m.forward_count,
    m.has_image
from "medical_warehouse"."analytics_staging"."stg_telegram_messages" as m
left join "medical_warehouse"."analytics_marts"."dim_channels" as c
    on m.channel_name = c.channel_name
left join "medical_warehouse"."analytics_marts"."dim_dates" as d
    on m.message_date::date = d.full_date
  );
  
[0m21:14:18.682241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:18.719695 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "analytics_marts.dim_channels" does not exist
LINE 22: left join "medical_warehouse"."analytics_marts"."dim_channel...
                   ^

[0m21:14:18.720594 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: ROLLBACK
[0m21:14:18.722592 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m21:14:18.727702 [debug] [Thread-1 (]: Database Error in model fct_messages (models\marts\fct_messages.sql)
  relation "analytics_marts.dim_channels" does not exist
  LINE 22: left join "medical_warehouse"."analytics_marts"."dim_channel...
                     ^
  compiled code at target\run\medical_warehouse\models\marts\fct_messages.sql
[0m21:14:18.728692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d5626-db7f-40de-9736-485c5642871f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D51C0690>]}
[0m21:14:18.729675 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model analytics_marts.fct_messages ............. [[31mERROR[0m in 0.09s]
[0m21:14:18.730674 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m21:14:18.730674 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models\marts\fct_messages.sql)
  relation "analytics_marts.dim_channels" does not exist
  LINE 22: left join "medical_warehouse"."analytics_marts"."dim_channel...
                     ^
  compiled code at target\run\medical_warehouse\models\marts\fct_messages.sql.
[0m21:14:18.732678 [debug] [MainThread]: On master: COMMIT
[0m21:14:18.733676 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:18.733676 [debug] [MainThread]: On master: COMMIT
[0m21:14:18.734674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:18.756231 [debug] [MainThread]: SQL status: COMMIT in 0.024 seconds
[0m21:14:18.756231 [debug] [MainThread]: On master: Close
[0m21:14:18.756231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:18.760383 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m21:14:18.760383 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m21:14:18.760383 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m21:14:18.760383 [info ] [MainThread]: 
[0m21:14:18.762389 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m21:14:18.762389 [debug] [MainThread]: Command end result
[0m21:14:18.788744 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:14:18.791799 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:14:18.797380 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m21:14:18.797380 [info ] [MainThread]: 
[0m21:14:18.797380 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:14:18.797380 [info ] [MainThread]: 
[0m21:14:18.797380 [error] [MainThread]: [31mFailure in model fct_messages (models\marts\fct_messages.sql)[0m
[0m21:14:18.797380 [error] [MainThread]:   Database Error in model fct_messages (models\marts\fct_messages.sql)
  relation "analytics_marts.dim_channels" does not exist
  LINE 22: left join "medical_warehouse"."analytics_marts"."dim_channel...
                     ^
  compiled code at target\run\medical_warehouse\models\marts\fct_messages.sql
[0m21:14:18.797380 [info ] [MainThread]: 
[0m21:14:18.797380 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\marts\fct_messages.sql
[0m21:14:18.797380 [info ] [MainThread]: 
[0m21:14:18.797380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:14:18.805308 [debug] [MainThread]: Command `dbt run` failed at 21:14:18.805308 after 1.84 seconds
[0m21:14:18.806319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D3605890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D3666CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192CC8D65D0>]}
[0m21:14:18.806319 [debug] [MainThread]: Flushing usage events
[0m21:14:25.704512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:25.721497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018770C26A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018770C14850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018770C157D0>]}


============================== 21:19:25.726506 | d2797745-09f4-41fa-acfc-673c8a0225ef ==============================
[0m21:19:25.726506 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:19:25.727508 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:19:25.985851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018771E35FD0>]}
[0m21:19:26.062597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876D450AD0>]}
[0m21:19:26.064191 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:19:26.349198 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:19:26.536796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:19:26.536796 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\dim_dates.sql
[0m21:19:26.538487 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\dim_channels.sql
[0m21:19:26.539040 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\fct_messages.sql
[0m21:19:26.887238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018772426650>]}
[0m21:19:27.038963 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:19:27.038963 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:19:27.069364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187725184D0>]}
[0m21:19:27.069364 [info ] [MainThread]: Found 1 test, 4 models, 1 source, 464 macros
[0m21:19:27.076001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018772426A90>]}
[0m21:19:27.076001 [info ] [MainThread]: 
[0m21:19:27.076001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:27.079094 [info ] [MainThread]: 
[0m21:19:27.079664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:27.086264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m21:19:27.174419 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:19:27.174419 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:19:27.174419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:27.200693 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.032 seconds
[0m21:19:27.209217 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:19:27.213582 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m21:19:27.214197 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m21:19:27.214197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:27.243352 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.029 seconds
[0m21:19:27.243352 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m21:19:27.247650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m21:19:27.253575 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m21:19:27.253575 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:19:27.253575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:27.289392 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.039 seconds
[0m21:19:27.295117 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m21:19:27.297227 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m21:19:27.297599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m21:19:27.299108 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m21:19:27.299108 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:19:27.299108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:27.325774 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m21:19:27.330009 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m21:19:27.331063 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m21:19:27.336184 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:27.336184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:19:27.339227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:27.379349 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m21:19:27.381909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018772463A10>]}
[0m21:19:27.381909 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:27.381909 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.381909 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:27.381909 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.381909 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:19:27.381909 [debug] [MainThread]: On master: Close
[0m21:19:27.388978 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m21:19:27.388978 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m21:19:27.388978 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m21:19:27.388978 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m21:19:27.399373 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.399373 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m21:19:27.441188 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.441188 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.441188 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    select
    message_id,
    channel_name,
    message_text,
    message_date,
    length(message_text) as message_length,
    view_count,
    forward_count,
    has_media,
    image_path
from "medical_warehouse"."raw"."telegram_messages"
where message_text is not null
  );
[0m21:19:27.441188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:19:27.477380 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m21:19:27.482686 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.482686 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."analytics_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m21:19:27.482686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:19:27.489418 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.489418 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m21:19:27.489418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:19:27.509200 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m21:19:27.509200 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.512773 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m21:19:27.519453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m21:19:27.523719 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup"
[0m21:19:27.530019 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m21:19:27.530019 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup" cascade
[0m21:19:27.539113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m21:19:27.539113 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m21:19:27.545898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018772353F50>]}
[0m21:19:27.545898 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_telegram_messages ....... [[32mCREATE VIEW[0m in 0.16s]
[0m21:19:27.549113 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m21:19:27.549113 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m21:19:27.549113 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_marts.dim_channels ...................... [RUN]
[0m21:19:27.549113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m21:19:27.549113 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m21:19:27.554839 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m21:19:27.554839 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m21:19:27.581454 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m21:19:27.585787 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m21:19:27.585787 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

select
    row_number() over () as channel_key,
    channel_name,
    case
        when lower(channel_name) like '%pharma%' then 'Pharmaceutical'
        when lower(channel_name) like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(view_count) as avg_views
from "medical_warehouse"."analytics_staging"."stg_telegram_messages"
group by channel_name
  );
  
[0m21:19:27.585787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:27.618944 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m21:19:27.627003 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m21:19:27.627003 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_warehouse"."analytics_marts"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m21:19:27.629017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:19:27.631981 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m21:19:27.632981 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m21:19:27.632981 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m21:19:27.635796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:19:27.638378 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."dim_channels__dbt_backup"
[0m21:19:27.641709 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m21:19:27.642707 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "medical_warehouse"."analytics_marts"."dim_channels__dbt_backup" cascade
[0m21:19:27.643671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:19:27.646356 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m21:19:27.646356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187728A94D0>]}
[0m21:19:27.649386 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_marts.dim_channels ................. [[32mSELECT 0[0m in 0.10s]
[0m21:19:27.650393 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m21:19:27.651394 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m21:19:27.651394 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_marts.dim_dates ......................... [RUN]
[0m21:19:27.652607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m21:19:27.653612 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m21:19:27.656612 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m21:19:27.657612 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m21:19:27.662796 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m21:19:27.664729 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m21:19:27.665516 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    cast(message_date as date) as full_date,
    extract(year from message_date)::int as year,
    extract(month from message_date)::int as month,
    extract(day from message_date)::int as day,
    extract(week from message_date)::int as week_of_year,
    extract(dow from message_date)::int as day_of_week,
    to_char(message_date, 'Day') as day_name,
    to_char(message_date, 'Month') as month_name,
    case when extract(dow from message_date) in (0,6) then true else false end as is_weekend
from "medical_warehouse"."analytics_staging"."stg_telegram_messages"
  );
  
[0m21:19:27.666608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:27.698954 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m21:19:27.703133 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m21:19:27.703133 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "medical_warehouse"."analytics_marts"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m21:19:27.703133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:19:27.703133 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m21:19:27.703133 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m21:19:27.703133 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m21:19:27.711147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:19:27.716299 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."dim_dates__dbt_backup"
[0m21:19:27.718340 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m21:19:27.718340 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "medical_warehouse"."analytics_marts"."dim_dates__dbt_backup" cascade
[0m21:19:27.720593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:19:27.722138 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m21:19:27.723177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187728D8C50>]}
[0m21:19:27.725147 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_marts.dim_dates .................... [[32mSELECT 0[0m in 0.07s]
[0m21:19:27.726141 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m21:19:27.727828 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m21:19:27.727828 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_marts.fct_messages ...................... [RUN]
[0m21:19:27.729371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.fct_messages)
[0m21:19:27.730761 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m21:19:27.736438 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m21:19:27.737467 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m21:19:27.743613 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m21:19:27.744649 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m21:19:27.746571 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

select
    s.message_id,
    dc.channel_key,
    dd.full_date as date_key,
    s.message_text,
    s.message_length,
    s.view_count,
    s.forward_count,
    s.has_media as has_image
from "medical_warehouse"."analytics_staging"."stg_telegram_messages" s
left join "medical_warehouse"."analytics_marts"."dim_channels" dc
    on s.channel_name = dc.channel_name
left join "medical_warehouse"."analytics_marts"."dim_dates" dd
    on cast(s.message_date as date) = dd.full_date
  );
  
[0m21:19:27.747053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:27.783565 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m21:19:27.789080 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m21:19:27.789080 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "medical_warehouse"."analytics_marts"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m21:19:27.793547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:19:27.793547 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m21:19:27.793547 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m21:19:27.797105 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m21:19:27.800095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:19:27.803676 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_messages__dbt_backup"
[0m21:19:27.804721 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m21:19:27.805684 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_messages__dbt_backup" cascade
[0m21:19:27.806686 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:19:27.809271 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m21:19:27.810280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2797745-09f4-41fa-acfc-673c8a0225ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187728D9010>]}
[0m21:19:27.811283 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_marts.fct_messages ................. [[32mSELECT 0[0m in 0.08s]
[0m21:19:27.812281 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m21:19:27.814946 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.815944 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:27.815944 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.817298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:27.857473 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m21:19:27.857473 [debug] [MainThread]: On master: Close
[0m21:19:27.858988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:27.858988 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m21:19:27.858988 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m21:19:27.858988 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m21:19:27.858988 [info ] [MainThread]: 
[0m21:19:27.858988 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m21:19:27.863694 [debug] [MainThread]: Command end result
[0m21:19:27.890143 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:19:27.890143 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:19:27.901418 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m21:19:27.902382 [info ] [MainThread]: 
[0m21:19:27.903382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:27.904387 [info ] [MainThread]: 
[0m21:19:27.904387 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:19:27.904387 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:27.904387 after 2.27 seconds
[0m21:19:27.907135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876FD5C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187708C8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876A190E50>]}
[0m21:19:27.907135 [debug] [MainThread]: Flushing usage events
[0m21:19:30.572108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:17.778108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026430E66150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026430D2D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026430D2D210>]}


============================== 21:23:17.785033 | c4255b7b-f8cd-440b-bc0c-bf56dc7bd784 ==============================
[0m21:23:17.785033 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:23:17.785033 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m21:23:18.002089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026431FEDA50>]}
[0m21:23:18.075077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642D6308D0>]}
[0m21:23:18.078394 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:23:18.369294 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:23:18.529713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:18.529713 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:23:18.533636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:18.580805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026430E979D0>]}
[0m21:23:18.688321 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:23:18.692071 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:23:18.738032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643267FD90>]}
[0m21:23:18.738032 [info ] [MainThread]: Found 1 test, 4 models, 1 source, 464 macros
[0m21:23:18.741968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643229C190>]}
[0m21:23:18.744975 [info ] [MainThread]: 
[0m21:23:18.745975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:18.745975 [info ] [MainThread]: 
[0m21:23:18.747945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:23:18.753116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m21:23:18.888300 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m21:23:18.889306 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:23:18.889306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:18.925793 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.036 seconds
[0m21:23:18.926792 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m21:23:18.928311 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m21:23:18.930320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m21:23:18.935887 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m21:23:18.935887 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:23:18.936888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:18.958655 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.022 seconds
[0m21:23:18.960641 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m21:23:18.962029 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m21:23:18.967771 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:18.968398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:23:18.968398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:18.999815 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m21:23:19.002600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4255b7b-f8cd-440b-bc0c-bf56dc7bd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264324FCD10>]}
[0m21:23:19.002600 [debug] [MainThread]: On master: ROLLBACK
[0m21:23:19.003598 [debug] [MainThread]: On master: COMMIT
[0m21:23:19.005103 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:19.005103 [debug] [MainThread]: On master: COMMIT
[0m21:23:19.007596 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:23:19.008120 [debug] [MainThread]: On master: Close
[0m21:23:19.012950 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m21:23:19.013962 [info ] [Thread-1 (]: 1 of 1 START test assert_no_future_messages .................................... [RUN]
[0m21:23:19.015469 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.assert_no_future_messages'
[0m21:23:19.015797 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m21:23:19.024923 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m21:23:19.026972 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m21:23:19.049771 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_no_future_messages"
[0m21:23:19.052614 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m21:23:19.052614 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_no_future_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "medical_warehouse"."analytics_staging"."stg_telegram_messages"
where message_date > current_timestamp
  
  
      
    ) dbt_internal_test
[0m21:23:19.052614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:23:19.089819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m21:23:19.093824 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: ROLLBACK
[0m21:23:19.095824 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: Close
[0m21:23:19.096854 [info ] [Thread-1 (]: 1 of 1 PASS assert_no_future_messages .......................................... [[32mPASS[0m in 0.08s]
[0m21:23:19.098361 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m21:23:19.100394 [debug] [MainThread]: On master: COMMIT
[0m21:23:19.100394 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:19.100394 [debug] [MainThread]: On master: COMMIT
[0m21:23:19.101906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:19.128064 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m21:23:19.129578 [debug] [MainThread]: On master: Close
[0m21:23:19.129578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:19.129578 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m21:23:19.131595 [debug] [MainThread]: Connection 'test.medical_warehouse.assert_no_future_messages' was properly closed.
[0m21:23:19.131595 [info ] [MainThread]: 
[0m21:23:19.131595 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:23:19.131595 [debug] [MainThread]: Command end result
[0m21:23:19.164765 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m21:23:19.166768 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m21:23:19.176620 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m21:23:19.176620 [info ] [MainThread]: 
[0m21:23:19.178131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:19.179138 [info ] [MainThread]: 
[0m21:23:19.180145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:23:19.181645 [debug] [MainThread]: Command `dbt test` succeeded at 21:23:19.181645 after 1.47 seconds
[0m21:23:19.181645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642A400E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264329F9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642A156590>]}
[0m21:23:19.182654 [debug] [MainThread]: Flushing usage events
[0m21:23:20.598373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:01.045359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204949F5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020494A38590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020494795E10>]}


============================== 23:18:01.052490 | 7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a ==============================
[0m23:18:01.052490 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:18:01.052490 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m23:18:01.560208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049469AFD0>]}
[0m23:18:01.636715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020491210550>]}
[0m23:18:01.638524 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:18:02.182135 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:18:03.939841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:03.939841 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:18:03.939841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:03.999980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020495BE3850>]}
[0m23:18:04.048780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049615F690>]}
[0m23:18:04.048780 [info ] [MainThread]: Found 1 test, 4 models, 1 source, 464 macros
[0m23:18:04.048780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d528ea9-9d4b-4f28-a4c4-c7d93d6c6d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020495E2B610>]}
[0m23:18:04.051579 [info ] [MainThread]: 
[0m23:18:04.053744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:04.053744 [info ] [MainThread]: 
[0m23:18:04.053744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:04.053744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m23:18:06.998221 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m23:18:06.998221 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:18:06.998221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:11.070750 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m23:18:15.149763 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:18:15.149763 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:18:15.149763 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m23:18:15.149763 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:18:15.149763 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: No close available on handle
[0m23:18:15.149763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m23:18:15.149763 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m23:18:15.149763 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m23:18:15.149763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:19.241110 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m23:18:23.321891 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m23:18:23.321891 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:18:23.321891 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m23:18:23.327495 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:18:23.327495 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: No close available on handle
[0m23:18:23.327495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:23.327495 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m23:18:23.327495 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m23:18:23.335395 [debug] [MainThread]: Command `dbt docs generate` failed at 23:18:23.335395 after 22.37 seconds
[0m23:18:23.335395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049619EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020495B98F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020495E8F090>]}
[0m23:18:23.335395 [debug] [MainThread]: Flushing usage events
[0m23:18:24.394381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:16.576422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C4196990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C4196710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C41D9490>]}


============================== 23:19:16.581486 | 81f7c531-922b-40dc-a866-4ad1024ea472 ==============================
[0m23:19:16.581486 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:19:16.582073 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m23:19:16.773644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C53EBA50>]}
[0m23:19:16.837125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C09B0310>]}
[0m23:19:16.837125 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:19:17.104071 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:19:17.334916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:17.334916 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:19:17.337645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:17.393405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C5382990>]}
[0m23:19:17.415883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C58FEB90>]}
[0m23:19:17.415883 [info ] [MainThread]: Found 1 test, 4 models, 1 source, 464 macros
[0m23:19:17.415883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C5834CD0>]}
[0m23:19:17.415883 [info ] [MainThread]: 
[0m23:19:17.425458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:19:17.426096 [info ] [MainThread]: 
[0m23:19:17.426096 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:17.431518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m23:19:17.523224 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m23:19:17.523887 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m23:19:17.523887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:17.624897 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.106 seconds
[0m23:19:17.624897 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m23:19:17.631619 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m23:19:17.631619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m23:19:17.631619 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m23:19:17.631619 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m23:19:17.631619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:17.656580 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m23:19:17.656580 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m23:19:17.662330 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m23:19:17.666042 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:17.666042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:19:17.666042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:17.703498 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m23:19:17.703498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f7c531-922b-40dc-a866-4ad1024ea472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C594C390>]}
[0m23:19:17.707453 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:17.707453 [debug] [MainThread]: On master: Close
[0m23:19:17.715789 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m23:19:17.715789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m23:19:17.716791 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m23:19:17.724293 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m23:19:17.725300 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m23:19:17.725300 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m23:19:17.725300 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m23:19:17.729345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m23:19:17.729345 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m23:19:17.732350 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m23:19:17.733380 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m23:19:17.734886 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m23:19:17.735912 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m23:19:17.736891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m23:19:17.736891 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m23:19:17.739920 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m23:19:17.740917 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m23:19:17.741892 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m23:19:17.742913 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m23:19:17.742913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m23:19:17.743891 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m23:19:17.747214 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m23:19:17.748214 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m23:19:17.749215 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m23:19:17.749215 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m23:19:17.750198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now model.medical_warehouse.fct_messages)
[0m23:19:17.750198 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m23:19:17.753213 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m23:19:17.754217 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m23:19:17.755181 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m23:19:17.756280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:17.757314 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m23:19:17.757314 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m23:19:17.758280 [debug] [MainThread]: Command end result
[0m23:19:17.891461 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m23:19:17.909708 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m23:19:17.919863 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m23:19:18.395241 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:19:18.395241 [info ] [MainThread]: Building catalog
[0m23:19:18.403944 [debug] [ThreadPool]: Acquiring new postgres connection 'medical_warehouse.information_schema'
[0m23:19:18.410717 [debug] [ThreadPool]: Using postgres connection "medical_warehouse.information_schema"
[0m23:19:18.410717 [debug] [ThreadPool]: On medical_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "medical_warehouse.information_schema"} */

    
    

    select
        'medical_warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('analytics_marts') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('analytics_staging') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('analytics_marts') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('analytics_marts') and
           upper(tbl.relname) = upper('fct_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:19:18.411659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:18.452188 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.040 seconds
[0m23:19:18.455186 [debug] [ThreadPool]: On medical_warehouse.information_schema: ROLLBACK
[0m23:19:18.456188 [debug] [ThreadPool]: On medical_warehouse.information_schema: Close
[0m23:19:18.469495 [debug] [MainThread]: Wrote artifact CatalogArtifact to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\catalog.json
[0m23:19:18.486842 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m23:19:18.494318 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m23:19:18.494318 [info ] [MainThread]: Catalog written to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\catalog.json
[0m23:19:18.494318 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:19:18.494318 after 1.99 seconds
[0m23:19:18.494318 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:19:18.497211 [debug] [MainThread]: Connection 'medical_warehouse.information_schema' was properly closed.
[0m23:19:18.497211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C2DA7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C106C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C106DD90>]}
[0m23:19:18.497211 [debug] [MainThread]: Flushing usage events
[0m23:19:19.541237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:08.943455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242D6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242C9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242CB810>]}


============================== 23:22:08.950916 | af016cd3-6753-4662-9dcf-d5dc8e3bbc64 ==============================
[0m23:22:08.950916 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:22:08.951488 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m23:22:09.181091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af016cd3-6753-4662-9dcf-d5dc8e3bbc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12546E590>]}
[0m23:22:09.259176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af016cd3-6753-4662-9dcf-d5dc8e3bbc64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C120AF05D0>]}
[0m23:26:28.756361 [error] [MainThread]: Encountered an error:

[0m23:26:28.803995 [error] [MainThread]: Traceback (most recent call last):
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:26:28.808026 [debug] [MainThread]: Command `dbt docs serve` failed at 23:26:28.808026 after 259.93 seconds
[0m23:26:28.810037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242D4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242D67D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1242CB390>]}
[0m23:26:28.810037 [debug] [MainThread]: Flushing usage events
[0m23:26:30.009711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:59:28.898747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A835D8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A83610DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A83610890>]}


============================== 00:59:28.903370 | 3edc9e28-f608-4d68-8bc4-237a0c0d65b1 ==============================
[0m00:59:28.903370 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:59:28.907619 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m00:59:28.948114 [info ] [MainThread]: dbt version: 1.11.2
[0m00:59:28.949650 [info ] [MainThread]: python version: 3.11.0
[0m00:59:28.950656 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m00:59:28.951160 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m00:59:29.040212 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m00:59:29.041181 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m00:59:29.041810 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m00:59:29.043816 [info ] [MainThread]: adapter type: postgres
[0m00:59:29.043816 [info ] [MainThread]: adapter version: 1.10.0
[0m00:59:29.158102 [info ] [MainThread]: Configuration:
[0m00:59:29.161186 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:59:29.161811 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:59:29.162819 [info ] [MainThread]: Required dependencies:
[0m00:59:29.162819 [debug] [MainThread]: Executing "git --help"
[0m00:59:29.213409 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:59:29.213409 [debug] [MainThread]: STDERR: "b''"
[0m00:59:29.214407 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:59:29.215410 [info ] [MainThread]: Connection:
[0m00:59:29.216187 [info ] [MainThread]:   host: localhost
[0m00:59:29.216187 [info ] [MainThread]:   port: 5432
[0m00:59:29.216187 [info ] [MainThread]:   user: postgres
[0m00:59:29.216187 [info ] [MainThread]:   database: medical_warehouse
[0m00:59:29.216187 [info ] [MainThread]:   schema: analytics
[0m00:59:29.220869 [info ] [MainThread]:   connect_timeout: 10
[0m00:59:29.220869 [info ] [MainThread]:   role: None
[0m00:59:29.221881 [info ] [MainThread]:   search_path: None
[0m00:59:29.222880 [info ] [MainThread]:   keepalives_idle: 0
[0m00:59:29.223433 [info ] [MainThread]:   sslmode: None
[0m00:59:29.223433 [info ] [MainThread]:   sslcert: None
[0m00:59:29.224440 [info ] [MainThread]:   sslkey: None
[0m00:59:29.225041 [info ] [MainThread]:   sslrootcert: None
[0m00:59:29.225041 [info ] [MainThread]:   application_name: dbt
[0m00:59:29.225041 [info ] [MainThread]:   retries: 1
[0m00:59:29.225041 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:59:29.523316 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:59:29.627850 [debug] [MainThread]: Using postgres connection "debug"
[0m00:59:29.627850 [debug] [MainThread]: On debug: select 1 as id
[0m00:59:29.627850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:29.724712 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m00:59:29.724712 [debug] [MainThread]: On debug: Close
[0m00:59:29.735027 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:29.735027 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:29.737123 [debug] [MainThread]: Command `dbt debug` succeeded at 00:59:29.737123 after 0.91 seconds
[0m00:59:29.737123 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:59:29.737123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A849B1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AFC8AB510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A848541D0>]}
[0m00:59:29.737123 [debug] [MainThread]: Flushing usage events
[0m00:59:30.968424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:04.639284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275447B9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275447F47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275447F5290>]}


============================== 01:01:04.648872 | ee61eb81-55d9-4f69-85a9-904118844371 ==============================
[0m01:01:04.648872 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:01:04.649953 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:01:04.845526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee61eb81-55d9-4f69-85a9-904118844371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275447BB050>]}
[0m01:01:04.907130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee61eb81-55d9-4f69-85a9-904118844371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027540FE0D10>]}
[0m01:01:04.915354 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:01:05.180540 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:01:05.356939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:01:05.356939 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\marts\fct_image_detections.sql
[0m01:01:05.559491 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.fct_image_detections' (models\marts\fct_image_detections.sql) depends on a source named 'raw.yolo_detections' which was not found
[0m01:01:05.559491 [debug] [MainThread]: Command `dbt run` failed at 01:01:05.559491 after 0.98 seconds
[0m01:01:05.559491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754481F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027545FB7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027545F32050>]}
[0m01:01:05.559491 [debug] [MainThread]: Flushing usage events
[0m01:01:06.636202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:13.131270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84F71F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84F01650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84F72CD0>]}


============================== 01:05:13.139353 | 224d5d8c-7091-4f8a-920e-f85f23faaf8f ==============================
[0m01:05:13.139353 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:05:13.139353 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:05:13.163318 [info ] [MainThread]: dbt version: 1.11.2
[0m01:05:13.163318 [info ] [MainThread]: python version: 3.11.0
[0m01:05:13.163318 [info ] [MainThread]: python path: E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\.venv\Scripts\python.exe
[0m01:05:13.163318 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m01:05:13.224378 [info ] [MainThread]: Using profiles dir at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse
[0m01:05:13.224378 [info ] [MainThread]: Using profiles.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\profiles.yml
[0m01:05:13.224378 [info ] [MainThread]: Using dbt_project.yml file at E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\dbt_project.yml
[0m01:05:13.228561 [info ] [MainThread]: adapter type: postgres
[0m01:05:13.228561 [info ] [MainThread]: adapter version: 1.10.0
[0m01:05:13.337675 [info ] [MainThread]: Configuration:
[0m01:05:13.337675 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:05:13.337675 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:05:13.337675 [info ] [MainThread]: Required dependencies:
[0m01:05:13.337675 [debug] [MainThread]: Executing "git --help"
[0m01:05:13.382243 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:05:13.382243 [debug] [MainThread]: STDERR: "b''"
[0m01:05:13.382243 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:05:13.382243 [info ] [MainThread]: Connection:
[0m01:05:13.389769 [info ] [MainThread]:   host: localhost
[0m01:05:13.389769 [info ] [MainThread]:   port: 5432
[0m01:05:13.389769 [info ] [MainThread]:   user: postgres
[0m01:05:13.389769 [info ] [MainThread]:   database: medical_warehouse
[0m01:05:13.389769 [info ] [MainThread]:   schema: analytics
[0m01:05:13.389769 [info ] [MainThread]:   connect_timeout: 10
[0m01:05:13.389769 [info ] [MainThread]:   role: None
[0m01:05:13.389769 [info ] [MainThread]:   search_path: None
[0m01:05:13.389769 [info ] [MainThread]:   keepalives_idle: 0
[0m01:05:13.394885 [info ] [MainThread]:   sslmode: None
[0m01:05:13.395896 [info ] [MainThread]:   sslcert: None
[0m01:05:13.395896 [info ] [MainThread]:   sslkey: None
[0m01:05:13.396894 [info ] [MainThread]:   sslrootcert: None
[0m01:05:13.396894 [info ] [MainThread]:   application_name: dbt
[0m01:05:13.398458 [info ] [MainThread]:   retries: 1
[0m01:05:13.399626 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:05:13.678539 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:05:13.750773 [debug] [MainThread]: Using postgres connection "debug"
[0m01:05:13.750773 [debug] [MainThread]: On debug: select 1 as id
[0m01:05:13.750773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:05:13.778439 [debug] [MainThread]: SQL status: SELECT 1 in 0.026 seconds
[0m01:05:13.778846 [debug] [MainThread]: On debug: Close
[0m01:05:13.778846 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:05:13.778846 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:05:13.781610 [debug] [MainThread]: Command `dbt debug` succeeded at 01:05:13.781610 after 0.71 seconds
[0m01:05:13.781610 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:05:13.781610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84CB4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFE3F27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFE1BB510>]}
[0m01:05:13.781610 [debug] [MainThread]: Flushing usage events
[0m01:05:14.856834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:36.075669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2AE3E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2AE8FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F29F5F890>]}


============================== 01:05:36.080301 | f8ffceca-77cf-4766-95fb-3ab0fe62b30f ==============================
[0m01:05:36.080301 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:05:36.081416 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:05:36.320243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2AEA6FD0>]}
[0m01:05:36.388892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F27670B10>]}
[0m01:05:36.390821 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:05:36.664355 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:05:36.822430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:05:36.823696 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\sources.yml
[0m01:05:36.823696 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\marts\fct_image_detections.sql
[0m01:05:37.283473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2BF56B10>]}
[0m01:05:37.376547 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:05:37.376547 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:05:37.408004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2BF71CD0>]}
[0m01:05:37.418072 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m01:05:37.418072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2BF33710>]}
[0m01:05:37.418072 [info ] [MainThread]: 
[0m01:05:37.422009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:37.423023 [info ] [MainThread]: 
[0m01:05:37.423023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:05:37.428503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m01:05:37.506397 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m01:05:37.506397 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:05:37.506397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:37.542951 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m01:05:37.542951 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m01:05:37.553147 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m01:05:37.553147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m01:05:37.556323 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m01:05:37.556323 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m01:05:37.556323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:37.584058 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.028 seconds
[0m01:05:37.589652 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m01:05:37.590397 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m01:05:37.594286 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:37.594286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:05:37.594286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:05:37.626103 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m01:05:37.626103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ffceca-77cf-4766-95fb-3ab0fe62b30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2BFE2210>]}
[0m01:05:37.626103 [debug] [MainThread]: On master: ROLLBACK
[0m01:05:37.626103 [debug] [MainThread]: On master: Close
[0m01:05:37.626103 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:05:37.636566 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m01:05:37.636566 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:05:37.647115 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:05:37.647115 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:05:37.647115 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:05:37.647115 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m01:05:37.647115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m01:05:37.647115 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:05:37.655936 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:05:37.655936 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:05:37.657475 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:05:37.658518 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m01:05:37.659516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m01:05:37.660096 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:05:37.662100 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:05:37.663605 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:05:37.664611 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:05:37.664611 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m01:05:37.666117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m01:05:37.666117 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m01:05:37.668825 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m01:05:37.669822 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m01:05:37.670825 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m01:05:37.671788 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m01:05:37.671788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now model.medical_warehouse.fct_messages)
[0m01:05:37.672786 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m01:05:37.676486 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m01:05:37.676486 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m01:05:37.677992 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m01:05:37.678998 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m01:05:37.678998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now model.medical_warehouse.fct_image_detections)
[0m01:05:37.680035 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m01:05:37.684036 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m01:05:37.684999 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m01:05:37.686035 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m01:05:37.686999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:37.686999 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m01:05:37.686999 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m01:05:37.689414 [debug] [MainThread]: Command end result
[0m01:05:37.709868 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:05:37.709868 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:05:37.725463 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m01:05:37.725463 [debug] [MainThread]: Command `dbt compile` succeeded at 01:05:37.725463 after 1.72 seconds
[0m01:05:37.725463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2ABE4B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2420B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2420B510>]}
[0m01:05:37.725463 [debug] [MainThread]: Flushing usage events
[0m01:05:38.767284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:45.946982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E19FC8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1A004AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E190EFAD0>]}


============================== 01:07:45.958144 | cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1 ==============================
[0m01:07:45.958144 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:07:45.958144 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'invocation_command': 'dbt run --select fct_image_detections', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:07:46.163249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1B227810>]}
[0m01:07:46.224943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E16860D50>]}
[0m01:07:46.224943 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:07:46.493567 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:07:46.649108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:46.649108 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:07:46.649108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:46.708233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1B66BA10>]}
[0m01:07:46.804856 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:07:46.804856 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:07:46.835911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1B787950>]}
[0m01:07:46.835911 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m01:07:46.835911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1B691AD0>]}
[0m01:07:46.835911 [info ] [MainThread]: 
[0m01:07:46.835911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:46.845717 [info ] [MainThread]: 
[0m01:07:46.845717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:46.845717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m01:07:46.959981 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:07:46.959981 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:07:46.959981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:46.991424 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m01:07:46.991424 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:07:47.001363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m01:07:47.007297 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m01:07:47.011858 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m01:07:47.011858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:47.032819 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.025 seconds
[0m01:07:47.038815 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m01:07:47.038815 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m01:07:47.038815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m01:07:47.043217 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m01:07:47.043217 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:07:47.043217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:47.064280 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.022 seconds
[0m01:07:47.070528 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m01:07:47.070528 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m01:07:47.074414 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:47.074414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:07:47.074414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:47.102310 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m01:07:47.102937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1B7A8F90>]}
[0m01:07:47.102937 [debug] [MainThread]: On master: ROLLBACK
[0m01:07:47.105456 [debug] [MainThread]: On master: COMMIT
[0m01:07:47.105456 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:47.105456 [debug] [MainThread]: On master: COMMIT
[0m01:07:47.105456 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m01:07:47.115566 [debug] [MainThread]: On master: Close
[0m01:07:47.119262 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m01:07:47.119262 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m01:07:47.119262 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m01:07:47.119262 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m01:07:47.129946 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m01:07:47.129946 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m01:07:47.175689 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m01:07:47.176655 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:07:47.177654 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (

    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"

),

messages AS (

    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"

)

SELECT
    m.message_id,
    m.channel_key,
    m.date_key,
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
  );
  
[0m01:07:47.177654 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:07:47.212009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.yolo_detections" does not exist
LINE 22:     FROM "medical_warehouse"."raw"."yolo_detections"
                  ^

[0m01:07:47.212009 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: ROLLBACK
[0m01:07:47.212009 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m01:07:47.353416 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  relation "raw.yolo_detections" does not exist
  LINE 22:     FROM "medical_warehouse"."raw"."yolo_detections"
                    ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m01:07:47.355125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd949cbb-7a5c-4666-ab8a-b2cc02efe8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1BB0F390>]}
[0m01:07:47.355125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_marts.fct_image_detections ..... [[31mERROR[0m in 0.23s]
[0m01:07:47.355125 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m01:07:47.355125 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  relation "raw.yolo_detections" does not exist
  LINE 22:     FROM "medical_warehouse"."raw"."yolo_detections"
                    ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql.
[0m01:07:47.355125 [debug] [MainThread]: On master: COMMIT
[0m01:07:47.355125 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:47.355125 [debug] [MainThread]: On master: COMMIT
[0m01:07:47.355125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:47.390490 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m01:07:47.391079 [debug] [MainThread]: On master: Close
[0m01:07:47.392258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:47.393339 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m01:07:47.394423 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m01:07:47.394938 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m01:07:47.395551 [info ] [MainThread]: 
[0m01:07:47.395551 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m01:07:47.395551 [debug] [MainThread]: Command end result
[0m01:07:47.425688 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:07:47.428704 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:07:47.435975 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m01:07:47.435975 [info ] [MainThread]: 
[0m01:07:47.435975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:07:47.435975 [info ] [MainThread]: 
[0m01:07:47.435975 [error] [MainThread]: [31mFailure in model fct_image_detections (models\marts\fct_image_detections.sql)[0m
[0m01:07:47.435975 [error] [MainThread]:   Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  relation "raw.yolo_detections" does not exist
  LINE 22:     FROM "medical_warehouse"."raw"."yolo_detections"
                    ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m01:07:47.441223 [info ] [MainThread]: 
[0m01:07:47.442231 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\marts\fct_image_detections.sql
[0m01:07:47.442896 [info ] [MainThread]: 
[0m01:07:47.442896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:07:47.446384 [debug] [MainThread]: Command `dbt run` failed at 01:07:47.446384 after 1.55 seconds
[0m01:07:47.446384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1334B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E1334B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E19FBDC50>]}
[0m01:07:47.447426 [debug] [MainThread]: Flushing usage events
[0m01:07:48.520902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:36.206148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAEDA9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAEA52AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAEE11D10>]}


============================== 01:45:36.209322 | 3f4822d9-8cda-4cfc-8d02-66026791f161 ==============================
[0m01:45:36.209322 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:45:36.209322 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:45:36.409236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAB86E8D0>]}
[0m01:45:36.471478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAB5D1490>]}
[0m01:45:36.471478 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:45:36.755568 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:45:36.901450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:45:36.901450 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:45:36.901450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:45:36.945723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB044E990>]}
[0m01:45:37.042334 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:45:37.042334 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:45:37.071111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB051EA50>]}
[0m01:45:37.074243 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m01:45:37.075126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAED9D750>]}
[0m01:45:37.076642 [info ] [MainThread]: 
[0m01:45:37.076642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:37.076642 [info ] [MainThread]: 
[0m01:45:37.076642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:45:37.084338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m01:45:37.211334 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m01:45:37.211334 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:45:37.211334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:37.252797 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.041 seconds
[0m01:45:37.252797 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m01:45:37.257552 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m01:45:37.258856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m01:45:37.258856 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m01:45:37.258856 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m01:45:37.258856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:37.284077 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m01:45:37.291072 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m01:45:37.292174 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m01:45:37.296255 [debug] [MainThread]: Using postgres connection "master"
[0m01:45:37.296255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:45:37.296255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:37.325553 [debug] [MainThread]: SQL status: SELECT 1 in 0.031 seconds
[0m01:45:37.325553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f4822d9-8cda-4cfc-8d02-66026791f161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB04A8450>]}
[0m01:45:37.325553 [debug] [MainThread]: On master: ROLLBACK
[0m01:45:37.334890 [debug] [MainThread]: On master: Close
[0m01:45:37.334890 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:45:37.334890 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m01:45:37.334890 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:45:37.345276 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:45:37.345276 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:45:37.345276 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:45:37.345276 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m01:45:37.345276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m01:45:37.345276 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:45:37.355678 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:45:37.358424 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:45:37.359880 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:45:37.359880 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m01:45:37.359880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m01:45:37.359880 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:45:37.359880 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:45:37.365935 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:45:37.365935 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:45:37.365935 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m01:45:37.365935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m01:45:37.365935 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m01:45:37.365935 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m01:45:37.365935 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m01:45:37.365935 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m01:45:37.365935 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m01:45:37.374823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now model.medical_warehouse.fct_messages)
[0m01:45:37.375628 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m01:45:37.376151 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m01:45:37.381010 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m01:45:37.381010 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m01:45:37.382922 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m01:45:37.383464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now model.medical_warehouse.fct_image_detections)
[0m01:45:37.384559 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m01:45:37.388359 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m01:45:37.389476 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m01:45:37.390656 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m01:45:37.392289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:37.392879 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m01:45:37.394287 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m01:45:37.394833 [debug] [MainThread]: Command end result
[0m01:45:37.425619 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:45:37.427906 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:45:37.427906 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m01:45:37.427906 [debug] [MainThread]: Command `dbt compile` succeeded at 01:45:37.427906 after 1.29 seconds
[0m01:45:37.427906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA83527D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA811B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA83BDD10>]}
[0m01:45:37.427906 [debug] [MainThread]: Flushing usage events
[0m01:45:38.813814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:06.022584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011120668F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000111206A4E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001112065D1D0>]}


============================== 01:46:06.022584 | 58b55566-6fce-40eb-97c1-793f0f5d5682 ==============================
[0m01:46:06.022584 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:46:06.022584 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_image_detections', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:46:06.241129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011120669190>]}
[0m01:46:06.303821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001111CE90950>]}
[0m01:46:06.303821 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:46:06.660250 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:46:06.804619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:06.804619 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:46:06.804619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:06.853108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011121B0D410>]}
[0m01:46:06.952243 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:46:06.952243 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:46:06.985608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011121E2B850>]}
[0m01:46:06.985942 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m01:46:06.985942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011121D68210>]}
[0m01:46:06.985942 [info ] [MainThread]: 
[0m01:46:06.985942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:06.985942 [info ] [MainThread]: 
[0m01:46:06.991057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:06.991057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m01:46:07.118614 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:46:07.118614 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:46:07.118614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:07.147802 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m01:46:07.151202 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:46:07.157041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m01:46:07.157597 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m01:46:07.157597 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m01:46:07.157597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:07.177868 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m01:46:07.184891 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m01:46:07.188038 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m01:46:07.188038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m01:46:07.188038 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m01:46:07.188038 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:46:07.188038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:07.209030 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.022 seconds
[0m01:46:07.217033 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m01:46:07.219516 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m01:46:07.225384 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:07.225384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:46:07.227392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:07.261588 [debug] [MainThread]: SQL status: SELECT 1 in 0.038 seconds
[0m01:46:07.261588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011121E4C250>]}
[0m01:46:07.268418 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:07.269399 [debug] [MainThread]: On master: COMMIT
[0m01:46:07.269399 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:07.271411 [debug] [MainThread]: On master: COMMIT
[0m01:46:07.271928 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:46:07.271928 [debug] [MainThread]: On master: Close
[0m01:46:07.271928 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m01:46:07.271928 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m01:46:07.271928 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m01:46:07.271928 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m01:46:07.291183 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m01:46:07.291183 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m01:46:07.340064 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m01:46:07.342027 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:07.343027 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (

    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"

),

messages AS (

    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"

)

SELECT
    m.message_id,
    m.channel_key,
    m.date_key,
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
  );
  
[0m01:46:07.343027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:07.395492 [debug] [Thread-1 (]: SQL status: SELECT 4231 in 0.052 seconds
[0m01:46:07.407850 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:07.407850 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m01:46:07.410667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:07.418535 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m01:46:07.427639 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:07.427639 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m01:46:07.434062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:46:07.438039 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup"
[0m01:46:07.438039 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:07.438039 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup" cascade
[0m01:46:07.449474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:46:07.451796 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m01:46:07.451796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58b55566-6fce-40eb-97c1-793f0f5d5682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011121896ED0>]}
[0m01:46:07.451796 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_marts.fct_image_detections ......... [[32mSELECT 4231[0m in 0.18s]
[0m01:46:07.451796 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m01:46:07.451796 [debug] [MainThread]: On master: COMMIT
[0m01:46:07.459424 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:07.459424 [debug] [MainThread]: On master: COMMIT
[0m01:46:07.459424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:07.480216 [debug] [MainThread]: SQL status: COMMIT in 0.022 seconds
[0m01:46:07.480216 [debug] [MainThread]: On master: Close
[0m01:46:07.483590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:07.484968 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m01:46:07.485542 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m01:46:07.485542 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m01:46:07.485542 [info ] [MainThread]: 
[0m01:46:07.485542 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m01:46:07.485542 [debug] [MainThread]: Command end result
[0m01:46:07.519735 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:46:07.523257 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:46:07.525561 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m01:46:07.525561 [info ] [MainThread]: 
[0m01:46:07.531996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:46:07.531996 [info ] [MainThread]: 
[0m01:46:07.531996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:46:07.534418 [debug] [MainThread]: Command `dbt run` succeeded at 01:46:07.534418 after 1.59 seconds
[0m01:46:07.535733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011119BFBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000111199BB6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000111199BB710>]}
[0m01:46:07.536240 [debug] [MainThread]: Flushing usage events
[0m01:46:08.572881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:40.010439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D36ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D36F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D36F210>]}


============================== 01:46:40.010439 | 95aeec8e-8d28-4bb8-8fd2-218154285f81 ==============================
[0m01:46:40.010439 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:46:40.010439 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m01:46:40.213839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74CACE710>]}
[0m01:46:40.288092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E749B91910>]}
[0m01:46:40.288092 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:46:40.563262 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:46:40.709252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:40.710109 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:46:40.710109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:40.758997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74E506B90>]}
[0m01:46:40.860162 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:46:40.860162 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:46:40.891550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74EB2B6D0>]}
[0m01:46:40.891550 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m01:46:40.893443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74E7EC590>]}
[0m01:46:40.893443 [info ] [MainThread]: 
[0m01:46:40.893443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:40.893443 [info ] [MainThread]: 
[0m01:46:40.893443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:40.902019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m01:46:41.035130 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:46:41.035130 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:46:41.035130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:41.063044 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m01:46:41.064046 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:46:41.068541 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:46:41.069538 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:46:41.069538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:41.093546 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m01:46:41.093546 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:46:41.097937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m01:46:41.103493 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m01:46:41.103493 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m01:46:41.103493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:41.139288 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m01:46:41.139288 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m01:46:41.141924 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m01:46:41.142568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m01:46:41.142568 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m01:46:41.142568 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:46:41.142568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:41.170914 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.025 seconds
[0m01:46:41.174659 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m01:46:41.174659 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m01:46:41.181245 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:41.181245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:46:41.181245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:41.213100 [debug] [MainThread]: SQL status: SELECT 1 in 0.038 seconds
[0m01:46:41.222789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74EEC44D0>]}
[0m01:46:41.223302 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:41.223302 [debug] [MainThread]: On master: COMMIT
[0m01:46:41.223302 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:41.223302 [debug] [MainThread]: On master: COMMIT
[0m01:46:41.223302 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:46:41.223302 [debug] [MainThread]: On master: Close
[0m01:46:41.233553 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:46:41.233553 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_telegram_messages ............ [RUN]
[0m01:46:41.233553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m01:46:41.233553 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:46:41.243967 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.243967 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:46:41.276710 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.276710 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.276710 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    select
    message_id,
    channel_name,
    message_text,
    message_date,
    length(message_text) as message_length,
    view_count,
    forward_count,
    has_media,
    image_path
from "medical_warehouse"."raw"."telegram_messages"
where message_text is not null
  );
[0m01:46:41.276710 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:41.316406 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m01:46:41.322734 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.323735 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."analytics_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m01:46:41.326868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:46:41.331059 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.331894 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m01:46:41.334009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.351383 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:46:41.352345 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.352345 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:46:41.356980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:46:41.363183 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup"
[0m01:46:41.367730 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:46:41.368736 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."analytics_staging"."stg_telegram_messages__dbt_backup" cascade
[0m01:46:41.372227 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:46:41.375232 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m01:46:41.378085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74EE269D0>]}
[0m01:46:41.379092 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_staging.stg_telegram_messages ....... [[32mCREATE VIEW[0m in 0.14s]
[0m01:46:41.380092 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:46:41.381091 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m01:46:41.381091 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics_marts.dim_channels ...................... [RUN]
[0m01:46:41.382091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m01:46:41.383092 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:46:41.386386 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:46:41.387390 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:46:41.413584 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m01:46:41.414522 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:46:41.415523 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

select
    row_number() over () as channel_key,
    channel_name,
    case
        when lower(channel_name) like '%pharma%' then 'Pharmaceutical'
        when lower(channel_name) like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(view_count) as avg_views
from "medical_warehouse"."analytics_staging"."stg_telegram_messages"
group by channel_name
  );
  
[0m01:46:41.415523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:41.462750 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m01:46:41.469258 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:46:41.470260 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_warehouse"."analytics_marts"."dim_channels" rename to "dim_channels__dbt_backup"
[0m01:46:41.472000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.477697 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:46:41.479150 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_warehouse"."analytics_marts"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m01:46:41.480319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.482593 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:46:41.483622 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:46:41.484599 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:46:41.487613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:46:41.490277 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."dim_channels__dbt_backup"
[0m01:46:41.494686 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:46:41.494686 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "medical_warehouse"."analytics_marts"."dim_channels__dbt_backup" cascade
[0m01:46:41.499708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:46:41.500686 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m01:46:41.502196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74E5363D0>]}
[0m01:46:41.503208 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics_marts.dim_channels ................. [[32mSELECT 0[0m in 0.12s]
[0m01:46:41.505305 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:46:41.506574 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m01:46:41.507582 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics_marts.dim_dates ......................... [RUN]
[0m01:46:41.508144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m01:46:41.509149 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:46:41.512357 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:46:41.513400 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:46:41.517402 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m01:46:41.518364 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:46:41.519363 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    cast(message_date as date) as full_date,
    extract(year from message_date)::int as year,
    extract(month from message_date)::int as month,
    extract(day from message_date)::int as day,
    extract(week from message_date)::int as week_of_year,
    extract(dow from message_date)::int as day_of_week,
    to_char(message_date, 'Day') as day_name,
    to_char(message_date, 'Month') as month_name,
    case when extract(dow from message_date) in (0,6) then true else false end as is_weekend
from "medical_warehouse"."analytics_staging"."stg_telegram_messages"
  );
  
[0m01:46:41.519363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:41.554544 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m01:46:41.564461 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:46:41.564461 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "medical_warehouse"."analytics_marts"."dim_dates" rename to "dim_dates__dbt_backup"
[0m01:46:41.564461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.571353 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:46:41.571353 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "medical_warehouse"."analytics_marts"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m01:46:41.571353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.574865 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:46:41.576142 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:46:41.582636 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:46:41.586230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:46:41.589187 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."dim_dates__dbt_backup"
[0m01:46:41.590158 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:46:41.590158 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "medical_warehouse"."analytics_marts"."dim_dates__dbt_backup" cascade
[0m01:46:41.594039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:46:41.596613 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m01:46:41.597585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F2E6810>]}
[0m01:46:41.598584 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics_marts.dim_dates .................... [[32mSELECT 0[0m in 0.09s]
[0m01:46:41.599611 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:46:41.599611 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m01:46:41.600584 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics_marts.fct_messages ...................... [RUN]
[0m01:46:41.601584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.fct_messages)
[0m01:46:41.601584 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m01:46:41.604623 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m01:46:41.606155 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m01:46:41.612061 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m01:46:41.613032 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:46:41.613538 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

select
    s.message_id,
    dc.channel_key,
    dd.full_date as date_key,
    s.message_text,
    s.message_length,
    s.view_count,
    s.forward_count,
    s.has_media as has_image
from "medical_warehouse"."analytics_staging"."stg_telegram_messages" s
left join "medical_warehouse"."analytics_marts"."dim_channels" dc
    on s.channel_name = dc.channel_name
left join "medical_warehouse"."analytics_marts"."dim_dates" dd
    on cast(s.message_date as date) = dd.full_date
  );
  
[0m01:46:41.614548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:41.660097 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m01:46:41.663103 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:46:41.663103 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "medical_warehouse"."analytics_marts"."fct_messages" rename to "fct_messages__dbt_backup"
[0m01:46:41.664762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.668406 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:46:41.668406 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "medical_warehouse"."analytics_marts"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m01:46:41.670414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.672448 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m01:46:41.672448 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:46:41.673446 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m01:46:41.676368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:46:41.678939 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_messages__dbt_backup"
[0m01:46:41.679974 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:46:41.680973 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_messages__dbt_backup" cascade
[0m01:46:41.689166 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m01:46:41.690766 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m01:46:41.691804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74EEC5910>]}
[0m01:46:41.692775 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics_marts.fct_messages ................. [[32mSELECT 0[0m in 0.09s]
[0m01:46:41.693772 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m01:46:41.693772 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m01:46:41.693772 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m01:46:41.693772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now model.medical_warehouse.fct_image_detections)
[0m01:46:41.693772 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m01:46:41.699791 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m01:46:41.699791 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m01:46:41.704367 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m01:46:41.704367 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:41.704367 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (

    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"

),

messages AS (

    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"

)

SELECT
    m.message_id,
    m.channel_key,
    m.date_key,
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
  );
  
[0m01:46:41.704367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:41.744659 [debug] [Thread-1 (]: SQL status: SELECT 4231 in 0.037 seconds
[0m01:46:41.744659 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:41.744659 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m01:46:41.751394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.751394 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:41.751394 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m01:46:41.751394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:41.760102 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m01:46:41.760102 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:41.760102 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m01:46:41.767318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:46:41.770346 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup"
[0m01:46:41.770346 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m01:46:41.771852 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup" cascade
[0m01:46:41.776415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:46:41.778496 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m01:46:41.779464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95aeec8e-8d28-4bb8-8fd2-218154285f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F305C50>]}
[0m01:46:41.780463 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics_marts.fct_image_detections ......... [[32mSELECT 4231[0m in 0.08s]
[0m01:46:41.782007 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m01:46:41.783019 [debug] [MainThread]: On master: COMMIT
[0m01:46:41.784016 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:41.784016 [debug] [MainThread]: On master: COMMIT
[0m01:46:41.785016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:41.810508 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m01:46:41.811379 [debug] [MainThread]: On master: Close
[0m01:46:41.812900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:41.813509 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m01:46:41.813509 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m01:46:41.813509 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m01:46:41.813509 [info ] [MainThread]: 
[0m01:46:41.813509 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m01:46:41.813509 [debug] [MainThread]: Command end result
[0m01:46:41.843479 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m01:46:41.846487 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m01:46:41.853998 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m01:46:41.853998 [info ] [MainThread]: 
[0m01:46:41.853998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:46:41.853998 [info ] [MainThread]: 
[0m01:46:41.853998 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:46:41.853998 [debug] [MainThread]: Command `dbt run` succeeded at 01:46:41.853998 after 1.91 seconds
[0m01:46:41.859460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74667B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74667B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74691DD10>]}
[0m01:46:41.859460 [debug] [MainThread]: Flushing usage events
[0m01:46:43.165117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:44:24.443922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89E7EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89EEBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89EEBED0>]}


============================== 02:44:24.456904 | 87b6a8a2-6f87-4865-bed0-94d17cfff79c ==============================
[0m02:44:24.456904 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:44:24.456904 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m02:44:24.682048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89EEB050>]}
[0m02:44:24.743477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E866A2150>]}
[0m02:44:24.743477 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:44:25.011050 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:44:25.152943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:44:25.154129 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\fct_image_detections.sql
[0m02:44:25.433706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8B5D0BD0>]}
[0m02:44:25.560397 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m02:44:25.566970 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m02:44:25.594025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8B318090>]}
[0m02:44:25.594025 [info ] [MainThread]: Found 1 test, 5 models, 2 sources, 464 macros
[0m02:44:25.594025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8B6215D0>]}
[0m02:44:25.598026 [info ] [MainThread]: 
[0m02:44:25.598026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:25.598026 [info ] [MainThread]: 
[0m02:44:25.598026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:25.598026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m02:44:25.678525 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m02:44:25.679569 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m02:44:25.679569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:25.705184 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m02:44:25.706214 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m02:44:25.711804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m02:44:25.711804 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m02:44:25.711804 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m02:44:25.711804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:25.739056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m02:44:25.739056 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m02:44:25.743333 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m02:44:25.743333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m02:44:25.743333 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m02:44:25.743333 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m02:44:25.743333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:25.767642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m02:44:25.768678 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m02:44:25.770231 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m02:44:25.774480 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:25.774480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:44:25.774480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:25.802048 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m02:44:25.802048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8B59D9D0>]}
[0m02:44:25.802048 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:25.805697 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.805697 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:25.805697 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.805697 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:44:25.805697 [debug] [MainThread]: On master: Close
[0m02:44:25.805697 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m02:44:25.805697 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m02:44:25.805697 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m02:44:25.816025 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m02:44:25.818245 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m02:44:25.826482 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m02:44:25.867679 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m02:44:25.867679 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m02:44:25.867679 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (

    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"

),

messages AS (

    SELECT
        message_id,
        channel_key,
        channel_name,   -- include channel_name
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"

)

SELECT
    m.message_id,
    m.channel_key,
    m.channel_name,    -- select channel_name
    m.date_key,
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
  );
  
[0m02:44:25.867679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:44:25.898820 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_name" does not exist
LINE 31:         channel_name,   -- include channel_name
                 ^

[0m02:44:25.899415 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: ROLLBACK
[0m02:44:25.901048 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m02:44:25.907863 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  column "channel_name" does not exist
  LINE 31:         channel_name,   -- include channel_name
                   ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m02:44:25.909622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b6a8a2-6f87-4865-bed0-94d17cfff79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8BA598D0>]}
[0m02:44:25.910221 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_marts.fct_image_detections ..... [[31mERROR[0m in 0.10s]
[0m02:44:25.910221 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m02:44:25.910221 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  column "channel_name" does not exist
  LINE 31:         channel_name,   -- include channel_name
                   ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql.
[0m02:44:25.910221 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.910221 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:25.910221 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.910221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:25.939895 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m02:44:25.939895 [debug] [MainThread]: On master: Close
[0m02:44:25.939895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:25.939895 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m02:44:25.939895 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m02:44:25.950383 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m02:44:25.951030 [info ] [MainThread]: 
[0m02:44:25.951030 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:44:25.951030 [debug] [MainThread]: Command end result
[0m02:44:25.987186 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m02:44:25.991862 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m02:44:26.006069 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m02:44:26.006069 [info ] [MainThread]: 
[0m02:44:26.006069 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:44:26.006069 [info ] [MainThread]: 
[0m02:44:26.006069 [error] [MainThread]: [31mFailure in model fct_image_detections (models\marts\fct_image_detections.sql)[0m
[0m02:44:26.006069 [error] [MainThread]:   Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  column "channel_name" does not exist
  LINE 31:         channel_name,   -- include channel_name
                   ^
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m02:44:26.006069 [info ] [MainThread]: 
[0m02:44:26.006069 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\marts\fct_image_detections.sql
[0m02:44:26.012268 [info ] [MainThread]: 
[0m02:44:26.012268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:44:26.012268 [debug] [MainThread]: Command `dbt run` failed at 02:44:26.012268 after 1.62 seconds
[0m02:44:26.015058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89E84590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89B31290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89C27990>]}
[0m02:44:26.016102 [debug] [MainThread]: Flushing usage events
[0m02:44:27.174641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:49:23.281534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001438541DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014385487510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143854874D0>]}


============================== 02:49:23.287884 | 8feaeb10-81e6-4694-83cf-388ea7c319b7 ==============================
[0m02:49:23.287884 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:49:23.289022 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m02:49:23.514089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8feaeb10-81e6-4694-83cf-388ea7c319b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001438541E550>]}
[0m02:49:23.590239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8feaeb10-81e6-4694-83cf-388ea7c319b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014381CAE390>]}
[0m02:49:23.591879 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:49:23.859460 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:49:24.023131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:24.023131 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\fct_image_detections.sql
[0m02:49:24.219516 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.fct_image_detections' (models\marts\fct_image_detections.sql) depends on a source named 'raw.channel_mapping' which was not found
[0m02:49:24.219516 [debug] [MainThread]: Command `dbt run` failed at 02:49:24.219516 after 1.02 seconds
[0m02:49:24.219516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001438548C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001438548F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014386543A90>]}
[0m02:49:24.226570 [debug] [MainThread]: Flushing usage events
[0m02:49:25.340760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:08:33.033385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D823E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8178490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8279250>]}


============================== 03:08:33.039706 | e4aca6df-ac75-46de-b16e-9ff9e7309ba5 ==============================
[0m03:08:33.039706 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:08:33.040709 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_image_detections', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:08:33.254754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4aca6df-ac75-46de-b16e-9ff9e7309ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D7A184D0>]}
[0m03:08:33.321744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4aca6df-ac75-46de-b16e-9ff9e7309ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D4A4E690>]}
[0m03:08:33.321744 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:08:33.610864 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:08:33.750630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:08:33.750630 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\fct_image_detections.sql
[0m03:08:33.954311 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.fct_image_detections' (models\marts\fct_image_detections.sql) depends on a source named 'raw.channel_mapping' which was not found
[0m03:08:33.954970 [debug] [MainThread]: Command `dbt run` failed at 03:08:33.954970 after 0.98 seconds
[0m03:08:33.955977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8244390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D932B8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8237F50>]}
[0m03:08:33.956976 [debug] [MainThread]: Flushing usage events
[0m03:08:35.027120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:11:54.025289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA6D95D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAB907CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DABB5F110>]}


============================== 03:11:54.035649 | 032e916c-5381-44b1-ac11-74e4f9c814a3 ==============================
[0m03:11:54.035649 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:11:54.035649 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:11:54.240503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032e916c-5381-44b1-ac11-74e4f9c814a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DABB5F1D0>]}
[0m03:11:54.272180 [debug] [MainThread]: Command `dbt clean` succeeded at 03:11:54.272180 after 0.31 seconds
[0m03:11:54.272180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DABB64310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DABBCB5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DABBCB150>]}
[0m03:11:54.278321 [debug] [MainThread]: Flushing usage events
[0m03:11:55.493337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:09.173981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CED1EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CEAC7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CED17C90>]}


============================== 03:12:09.181340 | a4617198-ca34-4854-ab20-97c9b7a1fdfc ==============================
[0m03:12:09.181340 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:12:09.181340 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:12:09.338746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4617198-ca34-4854-ab20-97c9b7a1fdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFE20510>]}
[0m03:12:09.380366 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:12:09.380366 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:12:09.380366 [debug] [MainThread]: Command `dbt deps` succeeded at 03:12:09.380366 after 0.27 seconds
[0m03:12:09.380366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CED241D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFDF8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C7FC5050>]}
[0m03:12:09.390611 [debug] [MainThread]: Flushing usage events
[0m03:12:10.446298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:30.828654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52763F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52763EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52763EA50>]}


============================== 03:12:30.829615 | 6fabff20-eae3-4f63-b984-4d38d30085f2 ==============================
[0m03:12:30.829615 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:12:30.834688 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:12:31.073566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5288B5A10>]}
[0m03:12:31.149192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E523EA23D0>]}
[0m03:12:31.152021 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:12:31.444695 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:12:31.446248 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:12:31.446248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52883C690>]}
[0m03:12:32.981857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E527637110>]}
[0m03:12:33.088165 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:12:33.095847 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:12:33.116693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52908BF50>]}
[0m03:12:33.127105 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 464 macros
[0m03:12:33.127105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E528C13F10>]}
[0m03:12:33.129274 [info ] [MainThread]: 
[0m03:12:33.129274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:33.129274 [info ] [MainThread]: 
[0m03:12:33.129274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:33.129274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m03:12:33.217793 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m03:12:33.217793 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m03:12:33.217793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:33.251642 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.034 seconds
[0m03:12:33.255186 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m03:12:33.255186 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m03:12:33.255186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m03:12:33.262178 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m03:12:33.262178 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m03:12:33.262178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:33.293110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m03:12:33.295422 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m03:12:33.295422 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m03:12:33.303393 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:33.303393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:12:33.303393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:33.345177 [debug] [MainThread]: SQL status: SELECT 1 in 0.039 seconds
[0m03:12:33.345177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fabff20-eae3-4f63-b984-4d38d30085f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E528E886D0>]}
[0m03:12:33.345177 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:33.345177 [debug] [MainThread]: On master: Close
[0m03:12:33.354767 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m03:12:33.354767 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m03:12:33.354767 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m03:12:33.367255 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m03:12:33.367255 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m03:12:33.375253 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m03:12:33.375253 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m03:12:33.375253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m03:12:33.375253 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m03:12:33.382579 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m03:12:33.382579 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m03:12:33.382579 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m03:12:33.382579 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m03:12:33.385595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.dim_dates)
[0m03:12:33.385595 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m03:12:33.385595 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m03:12:33.385595 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m03:12:33.385595 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m03:12:33.385595 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m03:12:33.385595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m03:12:33.385595 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m03:12:33.395991 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m03:12:33.395991 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m03:12:33.398433 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m03:12:33.398433 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m03:12:33.398433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now model.medical_warehouse.fct_messages)
[0m03:12:33.398433 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m03:12:33.398433 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m03:12:33.398433 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m03:12:33.398433 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m03:12:33.406488 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m03:12:33.406488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now model.medical_warehouse.fct_image_detections)
[0m03:12:33.406488 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m03:12:33.406488 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m03:12:33.414219 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m03:12:33.414219 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m03:12:33.416819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:33.416819 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m03:12:33.416819 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m03:12:33.418975 [debug] [MainThread]: Command end result
[0m03:12:33.446317 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:12:33.447865 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:12:33.458088 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m03:12:33.458088 [debug] [MainThread]: Command `dbt compile` succeeded at 03:12:33.458088 after 2.69 seconds
[0m03:12:33.458088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52767D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5276AB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E520BEEA90>]}
[0m03:12:33.458088 [debug] [MainThread]: Flushing usage events
[0m03:12:34.524720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:23.573038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48FCFFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490587090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4902C7F10>]}


============================== 03:13:23.573038 | ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df ==============================
[0m03:13:23.573038 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:13:23.573038 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_image_detections', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:13:23.800659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48FCFF490>]}
[0m03:13:23.871994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48CD4CB10>]}
[0m03:13:23.876551 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:13:24.150971 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:13:24.315094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:13:24.315094 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:13:24.315094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:13:24.361552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C491ACE850>]}
[0m03:13:24.449803 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:13:24.449803 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:13:24.484920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C491C0DB10>]}
[0m03:13:24.484920 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 464 macros
[0m03:13:24.484920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C491795C50>]}
[0m03:13:24.484920 [info ] [MainThread]: 
[0m03:13:24.484920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:24.484920 [info ] [MainThread]: 
[0m03:13:24.491200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:24.491200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m03:13:24.579232 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m03:13:24.579232 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m03:13:24.580233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:24.606412 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m03:13:24.608681 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m03:13:24.614180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_marts'
[0m03:13:24.623099 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m03:13:24.624191 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m03:13:24.624727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:24.667334 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m03:13:24.668931 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m03:13:24.670022 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m03:13:24.671084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_marts, now list_medical_warehouse_analytics_staging)
[0m03:13:24.676065 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m03:13:24.676609 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m03:13:24.677620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:24.708706 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m03:13:24.714195 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m03:13:24.714823 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m03:13:24.719294 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:24.719294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:13:24.719294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:24.740599 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m03:13:24.746364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C491C1B910>]}
[0m03:13:24.746364 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:24.746364 [debug] [MainThread]: On master: COMMIT
[0m03:13:24.746364 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:24.746364 [debug] [MainThread]: On master: COMMIT
[0m03:13:24.750948 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m03:13:24.750948 [debug] [MainThread]: On master: Close
[0m03:13:24.802157 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m03:13:24.802157 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m03:13:24.802157 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m03:13:24.802157 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m03:13:24.816566 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m03:13:24.817660 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m03:13:24.868878 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m03:13:24.870877 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:13:24.871878 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (
    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"
),

messages AS (
    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"
),

channel_map AS (
    SELECT *
    FROM "medical_warehouse"."raw"."channel_mapping"
)

SELECT
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category,
    m.message_id,
    m.channel_key,
    c.channel_name,
    m.date_key
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
LEFT JOIN channel_map c
    ON m.channel_key = c.channel_key
  );
  
[0m03:13:24.872879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:13:24.895850 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: bigint = text
LINE 50:     ON m.channel_key = c.channel_key
                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m03:13:24.897510 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: ROLLBACK
[0m03:13:24.900504 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m03:13:24.908211 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  operator does not exist: bigint = text
  LINE 50:     ON m.channel_key = c.channel_key
                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m03:13:24.912240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecbfcb07-c186-47f4-8c22-dc7f8b7fd1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48FC89950>]}
[0m03:13:24.912240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_marts.fct_image_detections ..... [[31mERROR[0m in 0.11s]
[0m03:13:24.915548 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m03:13:24.915548 [debug] [Thread-4 (]: Marking all children of 'model.medical_warehouse.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  operator does not exist: bigint = text
  LINE 50:     ON m.channel_key = c.channel_key
                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql.
[0m03:13:24.918067 [debug] [MainThread]: On master: COMMIT
[0m03:13:24.918067 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:24.920591 [debug] [MainThread]: On master: COMMIT
[0m03:13:24.920591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:24.947041 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m03:13:24.948049 [debug] [MainThread]: On master: Close
[0m03:13:24.948615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:24.950623 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m03:13:24.950623 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_staging' was properly closed.
[0m03:13:24.950623 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m03:13:24.950623 [info ] [MainThread]: 
[0m03:13:24.950623 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m03:13:24.950623 [debug] [MainThread]: Command end result
[0m03:13:24.994462 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:13:24.994462 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:13:25.009146 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m03:13:25.009146 [info ] [MainThread]: 
[0m03:13:25.009146 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:13:25.009146 [info ] [MainThread]: 
[0m03:13:25.009146 [error] [MainThread]: [31mFailure in model fct_image_detections (models\marts\fct_image_detections.sql)[0m
[0m03:13:25.009146 [error] [MainThread]:   Database Error in model fct_image_detections (models\marts\fct_image_detections.sql)
  operator does not exist: bigint = text
  LINE 50:     ON m.channel_key = c.channel_key
                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\medical_warehouse\models\marts\fct_image_detections.sql
[0m03:13:25.015551 [info ] [MainThread]: 
[0m03:13:25.017292 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\marts\fct_image_detections.sql
[0m03:13:25.019307 [info ] [MainThread]: 
[0m03:13:25.019307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m03:13:25.023356 [debug] [MainThread]: Command `dbt run` failed at 03:13:25.019307 after 1.52 seconds
[0m03:13:25.023356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490517850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490516690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490517A50>]}
[0m03:13:25.025363 [debug] [MainThread]: Flushing usage events
[0m03:13:26.083104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:15:32.093162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002529312EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002529312D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002529312FD50>]}


============================== 03:15:32.096278 | f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e ==============================
[0m03:15:32.096278 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:15:32.096278 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m03:15:32.312747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252921F3850>]}
[0m03:15:32.381170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528F941890>]}
[0m03:15:32.381170 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:15:32.650754 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:15:32.794361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:15:32.803448 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\fct_image_detections.sql
[0m03:15:33.084641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025294638750>]}
[0m03:15:33.178803 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:15:33.178803 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:15:33.258238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002529427EC90>]}
[0m03:15:33.260778 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 464 macros
[0m03:15:33.260778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252943EF990>]}
[0m03:15:33.260778 [info ] [MainThread]: 
[0m03:15:33.260778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:33.260778 [info ] [MainThread]: 
[0m03:15:33.260778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:15:33.260778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m03:15:33.345426 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m03:15:33.345426 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m03:15:33.346427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:33.369017 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m03:15:33.369017 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m03:15:33.375474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m03:15:33.386323 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m03:15:33.386323 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m03:15:33.386323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:33.407417 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.029 seconds
[0m03:15:33.417618 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m03:15:33.417618 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m03:15:33.417618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m03:15:33.417618 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m03:15:33.417618 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m03:15:33.417618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:33.437902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m03:15:33.448604 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m03:15:33.448604 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m03:15:33.448604 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:33.448604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:15:33.458581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:15:33.491219 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m03:15:33.497069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252929083D0>]}
[0m03:15:33.497069 [debug] [MainThread]: On master: ROLLBACK
[0m03:15:33.497069 [debug] [MainThread]: On master: COMMIT
[0m03:15:33.497069 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:33.497069 [debug] [MainThread]: On master: COMMIT
[0m03:15:33.501517 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:15:33.501517 [debug] [MainThread]: On master: Close
[0m03:15:33.501517 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m03:15:33.501517 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m03:15:33.501517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m03:15:33.501517 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m03:15:33.512603 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m03:15:33.512603 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m03:15:33.561360 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m03:15:33.562327 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:15:33.562327 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (
    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"
),

messages AS (
    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"
),

channel_map AS (
    SELECT *
    FROM "medical_warehouse"."raw"."channel_mapping"
)

SELECT
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category,
    m.message_id,
    m.channel_key,
    c.channel_name,
    m.date_key
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
LEFT JOIN channel_map c
    ON CAST(m.channel_key AS TEXT) = c.channel_key  -- fix type mismatch
  );
  
[0m03:15:33.562327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:15:33.616692 [debug] [Thread-1 (]: SQL status: SELECT 4231 in 0.054 seconds
[0m03:15:33.625388 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:15:33.626894 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m03:15:33.626894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:15:33.626894 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:15:33.626894 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m03:15:33.626894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:15:33.651314 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m03:15:33.651314 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:15:33.651314 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m03:15:33.658000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:15:33.664481 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup"
[0m03:15:33.670684 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m03:15:33.672692 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup" cascade
[0m03:15:33.678868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:15:33.680968 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m03:15:33.684967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d7030a-cfeb-4fa1-9b9d-f46e07363f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025294CB6410>]}
[0m03:15:33.684967 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_marts.fct_image_detections ......... [[32mSELECT 4231[0m in 0.18s]
[0m03:15:33.684967 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m03:15:33.689388 [debug] [MainThread]: On master: COMMIT
[0m03:15:33.689388 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:33.689388 [debug] [MainThread]: On master: COMMIT
[0m03:15:33.689388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:15:33.710240 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m03:15:33.710240 [debug] [MainThread]: On master: Close
[0m03:15:33.710240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:33.710240 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m03:15:33.710240 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m03:15:33.710240 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m03:15:33.710240 [info ] [MainThread]: 
[0m03:15:33.710240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m03:15:33.719205 [debug] [MainThread]: Command end result
[0m03:15:33.747711 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m03:15:33.751855 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m03:15:33.757494 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m03:15:33.757494 [info ] [MainThread]: 
[0m03:15:33.757494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:33.757494 [info ] [MainThread]: 
[0m03:15:33.762262 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:15:33.762262 [debug] [MainThread]: Command `dbt run` succeeded at 03:15:33.762262 after 1.73 seconds
[0m03:15:33.762262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002529319B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252931850D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528C3D4390>]}
[0m03:15:33.762262 [debug] [MainThread]: Flushing usage events
[0m03:15:34.796678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:30.597139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFCA3E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFCA79C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFCA79490>]}


============================== 18:39:30.599948 | ad844024-96ea-4ea9-8105-6e205da1011f ==============================
[0m18:39:30.599948 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:39:30.599948 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_image_detections', 'use_experimental_parser': 'False', 'log_path': 'E:\\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\\medical_warehouse\\logs'}
[0m18:39:31.011773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFCA3F0D0>]}
[0m18:39:31.086613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF9266190>]}
[0m18:39:31.086613 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:39:31.620961 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:39:33.462004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:39:33.463420 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:39:33.464430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:39:33.518327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFE00E990>]}
[0m18:39:33.762462 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m18:39:33.764662 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m18:39:33.813828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFE13A650>]}
[0m18:39:33.814265 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 464 macros
[0m18:39:33.815555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFDCB7310>]}
[0m18:39:33.817108 [info ] [MainThread]: 
[0m18:39:33.818091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:33.818596 [info ] [MainThread]: 
[0m18:39:33.818596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:33.820601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m18:39:38.552218 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m18:39:38.553433 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m18:39:38.553433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:38.684726 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.130 seconds
[0m18:39:38.686726 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m18:39:38.695478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_analytics_staging'
[0m18:39:38.705432 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_staging"
[0m18:39:38.706432 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m18:39:38.707432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:38.750866 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.043 seconds
[0m18:39:38.752860 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: ROLLBACK
[0m18:39:38.754371 [debug] [ThreadPool]: On list_medical_warehouse_analytics_staging: Close
[0m18:39:38.755378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse_analytics_staging, now list_medical_warehouse_analytics_marts)
[0m18:39:38.760381 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_analytics_marts"
[0m18:39:38.760949 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_analytics_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m18:39:38.760949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:38.782268 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m18:39:38.783266 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: ROLLBACK
[0m18:39:38.785267 [debug] [ThreadPool]: On list_medical_warehouse_analytics_marts: Close
[0m18:39:38.793362 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:38.794952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:39:38.795773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:38.841241 [debug] [MainThread]: SQL status: SELECT 1 in 0.045 seconds
[0m18:39:38.843237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFE4D1C90>]}
[0m18:39:38.845414 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:38.847362 [debug] [MainThread]: On master: COMMIT
[0m18:39:38.847362 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:38.848370 [debug] [MainThread]: On master: COMMIT
[0m18:39:38.851371 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:39:38.852372 [debug] [MainThread]: On master: Close
[0m18:39:38.931866 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_image_detections
[0m18:39:38.933867 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_image_detections .............. [RUN]
[0m18:39:38.935868 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m18:39:38.937866 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m18:39:38.967705 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m18:39:38.970705 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m18:39:39.058815 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m18:39:39.060816 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m18:39:39.062034 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

WITH yolo_detections AS (
    SELECT
        CAST(message_id AS BIGINT) AS message_id,
        image_name,
        detected_class,
        confidence_score,
        image_category
    FROM "medical_warehouse"."raw"."yolo_detections"
),

messages AS (
    SELECT
        message_id,
        channel_key,
        date_key
    FROM "medical_warehouse"."analytics_marts"."fct_messages"
),

channel_map AS (
    SELECT *
    FROM "medical_warehouse"."raw"."channel_mapping"
)

SELECT
    y.image_name,
    y.detected_class,
    y.confidence_score,
    y.image_category,
    m.message_id,
    m.channel_key,
    c.channel_name,
    m.date_key
FROM yolo_detections y
LEFT JOIN messages m
    ON y.message_id = m.message_id
LEFT JOIN channel_map c
    ON CAST(m.channel_key AS TEXT) = c.channel_key  -- fix type mismatch
  );
  
[0m18:39:39.062034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:39:39.335009 [debug] [Thread-1 (]: SQL status: SELECT 4231 in 0.272 seconds
[0m18:39:39.345632 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m18:39:39.346636 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m18:39:39.347632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:39:39.351742 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m18:39:39.352707 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m18:39:39.353708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:39:39.368491 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m18:39:39.368491 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m18:39:39.368491 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m18:39:39.380621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:39:39.387621 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup"
[0m18:39:39.393170 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m18:39:39.394745 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "medical_warehouse"."analytics_marts"."fct_image_detections__dbt_backup" cascade
[0m18:39:39.420178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m18:39:39.428736 [debug] [Thread-1 (]: On model.medical_warehouse.fct_image_detections: Close
[0m18:39:39.432437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad844024-96ea-4ea9-8105-6e205da1011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BFE52D090>]}
[0m18:39:39.434619 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_marts.fct_image_detections ......... [[32mSELECT 4231[0m in 0.49s]
[0m18:39:39.436313 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m18:39:39.438015 [debug] [MainThread]: On master: COMMIT
[0m18:39:39.438588 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:39.439130 [debug] [MainThread]: On master: COMMIT
[0m18:39:39.439672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:39.455150 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m18:39:39.462008 [debug] [MainThread]: On master: Close
[0m18:39:39.463413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:39.464006 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m18:39:39.466246 [debug] [MainThread]: Connection 'list_medical_warehouse_analytics_marts' was properly closed.
[0m18:39:39.466246 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m18:39:39.466246 [info ] [MainThread]: 
[0m18:39:39.468520 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m18:39:39.468520 [debug] [MainThread]: Command end result
[0m18:39:39.510818 [debug] [MainThread]: Wrote artifact WritableManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\manifest.json
[0m18:39:39.513072 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\semantic_manifest.json
[0m18:39:39.513072 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\Shipping-a-Data-Product-From-Raw-Telegram-Data-to-an-Analytical-API-week_8\medical_warehouse\target\run_results.json
[0m18:39:39.513072 [info ] [MainThread]: 
[0m18:39:39.523434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:39:39.524059 [info ] [MainThread]: 
[0m18:39:39.526080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:39:39.528091 [debug] [MainThread]: Command `dbt run` succeeded at 18:39:39.528091 after 9.02 seconds
[0m18:39:39.529049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF5D54490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF5D54410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF5D54450>]}
[0m18:39:39.531049 [debug] [MainThread]: Flushing usage events
[0m18:39:40.274551 [debug] [MainThread]: An error was encountered while trying to flush usage events
